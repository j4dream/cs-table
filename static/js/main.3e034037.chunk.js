(this["webpackJsonpvirtualized-sc-table"]=this["webpackJsonpvirtualized-sc-table"]||[]).push([[0],{22:function(e,t,r){e.exports=r(37)},27:function(e,t,r){},28:function(e,t,r){},32:function(e,t,r){},36:function(e,t,r){},37:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(9),i=r.n(a),l=(r(27),r(3)),c=r(2),s=r(5),d=r(4),h=(r(28),r(6)),u=r(8),p=r(11),f=r.n(p),v=r(7);function g(){var e=document.createElement("div"),t=document.body||e;e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",t.appendChild(e);var r=e.offsetWidth,n=e.clientWidth;return t.removeChild(e),r-n}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=1;function r(e,n){if(n?(e.level=n.level+1,t<e.level&&(t=e.level)):e.level=1,e.children.length){var o=0;e.children.forEach((function(t){r(t,e),o+=t.colSpan})),e.colSpan=o}else e.colSpan=1}e.forEach((function(e){r(e)}));for(var n=[],o=0;o<t;o++)n.push([]);for(var a=[],i=e.slice(),l=0;i[l];l++)a.push(i[l]),i[l].children.length&&i.push.apply(i,Object(v.a)(i[l].children));return a.forEach((function(e){e.children.length?e.rowSpan=1:e.rowSpan=t-e.level+1,n[e.level-1].push(e)})),n}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=1,r=0;function n(e,o){if(o?(e.level=o.level+1,t<e.level&&(t=e.level)):e.level=1,!(e.children.length>0))return e.rowSpan=1,r++;var a=0;e.children.forEach((function(t){n(t,e),a+=t.rowSpan})),e.rowSpan=a}e.forEach((function(e){n(e)}));for(var o=[],a=0;a<r;a++)o.push([]);for(var i={},l=1;l<=t;l++)i[l]=0;for(var c=[],s=e.slice(),d=0;s[d];d++)c.push(s[d]),s[d].children&&s.push.apply(s,Object(v.a)(s[d].children));return c.forEach((function(e){0===e.children.length?e.colSpan=t-e.level+1:e.colSpan=1})),c.forEach((function(e){var t=e.rowSpan,r=e.level,n=0;e.start=i[r],e.parent&&e.parent.start>e.start&&(n+=e.parent.start-e.start,e.start+=n),i[r]+=n,o[i[r]].push(e),i[r]+=t})),o}var y=0;function w(){return y++}var H="";function Q(e,t){return H||["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].forEach((function(t){"function"===typeof e[t]&&(H=t)})),e[H](t)}var O=r(19),j=r.n(O),E=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).state={mouseDown:!1,dragging:!1},n.onMouseDown=n.onMouseDown.bind(Object(u.a)(n)),n.onMouseMove=n.onMouseMove.bind(Object(u.a)(n)),n.onMouseUp=n.onMouseUp.bind(Object(u.a)(n)),n}return Object(c.a)(r,[{key:"onMouseDown",value:function(e){if(0===e.button){var t=Object(a.findDOMNode)(this),r=this.props.handle;if(r&&!function(e,t,r){for(var n=e;n;){if(Q(e,t))return!0;if(n===r)return!1;n=n.parentNode}return!1}(e.target,r,t))return;this.addEvent();var n=Object(a.findDOMNode)(this).getBoundingClientRect(),o=n.width,i=n.height,l=n.left,c=n.top;this.setState({mouseDown:!0,originX:e.pageX,originY:e.pageY,elementX:l,elementY:c,width:o,height:i})}}},{key:"onMouseMove",value:function(e){var t=this,r=e.pageX-this.state.originX,n=e.pageY-this.state.originY,o=Math.abs(r)+Math.abs(n);!this.state.dragging&&o>2&&(this.props.onDragStart&&this.props.onDragStart(this.props.dragData),this.state.dragging=!0),this.state.dragging&&this.setState((function(e){var o={},a=e.elementX+r+document.body.scrollLeft,i=e.elementY+n+document.body.scrollTop;return"none"===t.props.axis&&(o.left=a,o.top=i),"x"===t.props.axis&&(o.left=a,o.top=e.elementY),"y"===t.props.axis&&(o.left=e.elementX,o.top=i),o}))}},{key:"onMouseUp",value:function(){this.removeEvent();var e=this.props.onDragStop;this.state.dragging&&(e&&e(),this.setState({dragging:!1}))}},{key:"addEvent",value:function(){document.onselectstart=function(){return!1},document.ondragstart=function(){return!1},document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)}},{key:"removeEvent",value:function(){document.onselectstart=null,document.ondragstart=null,document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"style",value:function(){var e=this.state,t=e.dragging,r=e.left,n=e.top,o=e.width,a=e.height;return t?{position:"fixed",opacity:.6,left:r,top:n,width:o,height:a,zIndex:12}:{}}},{key:"render",value:function(){return o.a.createElement("div",{style:this.style(),className:this.props.className,onMouseDown:this.onMouseDown},this.props.children)}}]),r}(o.a.Component);E.defaultProps={axis:"none",handle:null};var C=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(l.a)(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={style:{}},e.handleMouseDown=function(t){var r=e.props,n=r.column,o=r.type;if(e.draggingColumn){e.dragging=!0;for(var a=e.context.table,i=a.tableEl,l=a.colResizeProxy,c=a.rowResizeProxy,s=i.getBoundingClientRect(),d=s.left,h=s.top,u=t.target;u&&"TH"!==u.tagName;)u=u.parentNode;var p=u.getBoundingClientRect(),f=p.left-d+30,v=p.top-h+30,g=t.clientX,m=t.clientY,b=p.right-d;"hori"===e.direction&&(l.style.visibility="visible",l.style.left=b+"px");var y=p.bottom-h;"vert"===e.direction&&(c.style.visibility="visible",c.style.top=y+"px"),document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};var w=function(e){var t=e.clientX-g,r=b+t;l.style.left=Math.max(f,r)+"px";var n=e.clientY-m,o=y+n;c.style.top=Math.max(v,o)+"px"};document.addEventListener("mousemove",w),document.addEventListener("mouseup",(function t(r){if(e.dragging){if("hori"===e.direction){var a,i=r.clientX-g;if("col"===o&&(a=e.headerTree.getLastNode(n)),"row"===o){var s=n.level-1;a=e.headerTree.getDeepestNodeByIndex(s)}if("corner"===o)a=e.context.table.rowHeaderTree.getDeepestNodeByIndex();var d=(a.width||a.realWidth||a.minWidth)+i;a.width=d<80?80:d,a.realWidth=a.width}if("vert"===e.direction){var h,u=r.clientY-m;if("col"===o){var p=n.level+n.rowSpan-2;h=e.headerTree.getDeepestNodeByIndex(p)}if("row"===o&&(h=e.headerTree.getLastNode(n)),"corner"===o)h=e.context.table.colHeaderTree.getDeepestNodeByIndex();var f=h.height+u;h.height=f<30?30:f}e.dragging=!1,e.draggingColumn=null,document.body.style.cursor="",l.style.visibility="hidden",c.style.visibility="hidden",document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",t),document.onselectstart=null,document.ondragstart=null,e.context.table.onLayoutChange(),e.context.table.scheduleLayout()}}))}},e.handleMouseMove=function(t){var r=e.props.column;if(!e.headerTree.sortingColumn&&!e.dragging){for(var n=t.target;n&&"TH"!==n.tagName;)n=n.parentNode;var o=n.getBoundingClientRect(),a=document.body.style;if(o.width>12&&o.right-t.pageX<5){if(e.disableResizeCol)return;a.cursor="col-resize",e.draggingColumn=r,e.direction="hori"}else if(o.height>12&&o.bottom-t.clientY<5){if(e.disableResizeRow)return;a.cursor="row-resize",e.direction="vert",e.draggingColumn=r}else a.cursor="",e.draggingColumn=null,e.direction=null}},e.handleMouseOut=function(){document.body.style.cursor=""},e.onMouseEnter=function(){var t=e.props,r=t.column,n=t.type,o=e.context.table,a=o.colHeaderTree,i=o.rowHeaderTree;"col"===n?(a.sortingColumn&&a.sortSameLevelPos(r)&&e.context.table.refreshColumn(),a.sortingColumn=null):(i.sortingColumn&&i.sortSameLevelPos(r)&&e.context.table.refreshColumn(),i.sortingColumn=null)},e.handleSortStart=function(){var t=e.props,r=t.column,n=t.type,o=e.context.table,a=o.colHeaderTree,i=o.rowHeaderTree;"col"===n?a.sortingColumn=r:i.sortingColumn=r},e.handleSortStop=function(){setTimeout((function(){var t=e.context.table,r=t.colHeaderTree,n=t.rowHeaderTree;r.sortingColumn=null,n.sortingColumn=null}),200)},e}return Object(c.a)(r,[{key:"dispatchEvent",value:function(e){for(var t=this.props[e],r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];t&&t.apply(void 0,n)}},{key:"getEextraProps",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.column,r=e.type,n=this.state.style,a=t.colSpan,i=t.rowSpan,l=t.name,c=t.children,s=this.context.table.props.sortSameLevelColumn;return o.a.createElement("th",{colSpan:a,rowSpan:i,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onMouseDown:this.handleMouseDown,onMouseEnter:this.onMouseEnter,className:j()({leaf:!c}),height:t.computedHeight(),style:n},s?o.a.createElement(E,{handle:".icon",axis:"col"===r?"x":"y",onDragStart:this.handleSortStart,onDragStop:this.handleSortStop},o.a.createElement("div",{className:"cell exchange"},o.a.createElement("div",{className:"icon ".concat("col"===r?"x":"y")}),l)):o.a.createElement("div",{className:"cell"},l))}},{key:"headerTree",get:function(){var e=this.props.type;return"row"===e?this.context.table.rowHeaderTree:"col"===e?this.context.table.colHeaderTree:{}}},{key:"disableResizeCol",get:function(){return!this.context.table.props.resizeWidth}},{key:"disableResizeRow",get:function(){return!this.context.table.props.resizeHeight}}]),r}(o.a.Component);C.contextTypes={table:f.a.any};var x=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(){return Object(l.a)(this,r),t.apply(this,arguments)}return Object(c.a)(r,[{key:"getColWidth",value:function(e){return e>100?e:100}},{key:"render",value:function(){var e=this,t=this.props,r=t.colHeaderWidth,n=t.store,a=n.columnHeader;return o.a.createElement("table",{border:"0",cellPadding:"0",cellSpacing:"0",style:{borderBottom:0,width:r}},o.a.createElement("colgroup",null,n.columns.map((function(e){var t=e.realWidth,r=e.prop;return o.a.createElement("col",{width:t,style:{width:t},key:r})}))),o.a.createElement("thead",null,a.map((function(t){return o.a.createElement("tr",{key:w()},t.map((function(e){return o.a.createElement(C,{type:"col",column:e,key:e.prop})})),o.a.createElement("th",{className:"gutter-col",style:{width:e.gutterWidth}}))}))))}},{key:"gutterWidth",get:function(){var e=this.props.store,t=e.forceHideYGutter,r=e.scrollY,n=e.gutterWidth;return t||!r?0:n}}]),r}(o.a.Component),R=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(){return Object(l.a)(this,r),t.apply(this,arguments)}return Object(c.a)(r,[{key:"render",value:function(){var e=this.props,t=e.store,r=e.tree,n=t.rowTableColGroup,a=t.rowHeader,i=t.rowHeaderWidth;return o.a.createElement("table",{border:"0",cellSpacing:"0",style:{width:i}},o.a.createElement("colgroup",null,n.map((function(e){var t=e.realWidth,r=e.key;return o.a.createElement("col",{width:t,style:{realWidth:t},key:r})}))),o.a.createElement("thead",null,a.map((function(e){return o.a.createElement("tr",{key:w()},e.map((function(e){return o.a.createElement(C,{type:"row",column:e,key:w()})})))})),t.scrollX&&o.a.createElement("tr",null,o.a.createElement("th",{className:"gutter-row",colSpan:r.deepestNodePath.length,height:"17"}))))}}]),r}(o.a.Component),S=r(20),W=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(l.a)(this,r),(n=t.call(this,e)).state={recordsInView:[],offsetIndex:0},n.lazyRenderRows=Object(S.throttle)(500,n.lazyRenderRows),n}return Object(c.a)(r,[{key:"getCellHeight",value:function(e){var t=this.props,r=t.showRowHeader,n=t.store.rowGroup;return r&&n&&n.length?n[e].computedHeight()-1:30}},{key:"getMapData",value:function(){var e=this,t=this.props.store,r=t.rowGroup,n=t.data,a=t.columns;return this.props.isNoData?o.a.createElement("tr",null):r.map((function(t,r){return o.a.createElement("tr",{key:w()},a.map((function(a){return o.a.createElement("td",{key:w()},o.a.createElement("div",{className:"cell",style:{height:e.getCellHeight(r)}},n[t.prop]&&n[t.prop][a.prop]))})))}))}},{key:"getLazyData",value:function(){var e=this,t=this.props,r=t.store,n=t.isNoData,a=this.state.recordsInView;return n?o.a.createElement("tr",null):a.map((function(t,n){return o.a.createElement("tr",{key:w()},r.columns.map((function(r){return o.a.createElement("td",{key:w()},o.a.createElement("div",{className:"cell",style:{height:e.getCellHeight(n)}},t&&t[r.prop]))})))}))}},{key:"lazyRenderRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.props.store,r=t.rowGroup,n=t.data;if(r.length){for(var o=[],a=0;a<this.props.rowsInView;a++){var i=r[e+a];if(i){var l=i.prop,c=n[l];o.push(c)}}this.setState({recordsInView:o,offsetIndex:e})}}},{key:"render",value:function(){var e=this.props,t=e.colHeaderWidth,r=e.store,n=e.lazyLoading,a=e.isNoData,i=this.state.offsetIndex;return n?o.a.createElement("div",{style:{height:a?0:30*this.rows}},o.a.createElement("table",{border:"0",cellSpacing:"0",style:{width:t-(r.scrollY?r.gutterWidth:0),transform:"translate(0, ".concat(30*i,"px)")},className:"dc-table-real-body"},o.a.createElement("colgroup",null,r.columns.map((function(e,t){return o.a.createElement("col",{width:e.realWidth,style:{width:e.realWidth},key:e.prop})}))),o.a.createElement("tbody",null,this.getLazyData()))):o.a.createElement("table",{border:"0",cellSpacing:"0",style:{width:t-(r.scrollY?r.gutterWidth:0)},className:"dc-table-real-body"},o.a.createElement("colgroup",null,r.columns.map((function(e,t){return o.a.createElement("col",{width:e.realWidth,style:{width:e.realWidth},key:e.prop})}))),o.a.createElement("tbody",null,this.getMapData()))}},{key:"rows",get:function(){return this.props.store.rowGroup.length}}]),r}(o.a.Component);W.defaultProps={rowsInView:20};var k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(t.children,t.name),n=t.prop,o=t.field,a=t.width,i=t.height,c=void 0===i?40:i;Object(l.a)(this,e),this.parent=null,this.children=[],this.data=null,this.key=null,this.level=null,this.colSpan=0,this.rowSpan=0,this.width=null,this.height=0,this.minHeight=30,this.minWidth=80,this.realWidth=80,this.prop=null,this.field=null,this.name="",this.name=r,this.prop=n||o,this.width=a,this.realWidth=a,this.height=c,this.key=w()}return Object(c.a)(e,[{key:"addChild",value:function(e){this.children.push(e)}},{key:"computedHeight",value:function(){return this.height||this.minHeight}},{key:"clear",value:function(){this.parent=void 0,this.data=void 0,this.key=void 0,this.colSpan=void 0,this.rowSpan=void 0,this.width=void 0,this.height=void 0,this.minHeight=void 0,this.minWidth=void 0,this.realWidth=void 0,this.field=void 0,this.name=void 0,this.start=void 0}}]),e}(),M=r(14),N=r.n(M),z=r(21),D=r.n(z),T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object(l.a)(this,e),this.children=[],this.deepestNodePath=[],this.leafNodes=[],this.setting={},this.sorting=[],this.root=new k,this.sortingColumn=null,this.setting=r,this.sorting=n,this.buildTree(t)}return Object(c.a)(e,[{key:"buildTree",value:function(e){this._initTree(e),this.deepestNodePath=this._findDeepestNodePath(),this.leafNodes=this.getLeafNodes()}},{key:"_traverse",value:function(e,t){var r=this,n=e.prop,o=e.field,a=this.setting[n]||this.setting[o];a&&Object.assign(e,a);var i=new k(e);t&&(i.parent=t,t.addChild(i)),e.children&&e.children.forEach((function(e){r._traverse(e,i)}))}},{key:"_initTree",value:function(e){var t=this,r=(new Date).getTime();if(this.sorting){var n={children:N()(e),prop:"root"},o={children:e,prop:"root"},a={children:this.sorting,prop:"root"};this.traverseDF((function(e){var r=e.prop,n=t.getNodeByProp(r,o),i=t.getNodeByProp(r,a);i&&t.soredNodesWidthSeq(n.children,i.children)}),n)}var i=(new Date).getTime();console.log("used time: ",i-r),e.forEach((function(e){t._traverse(e,t.root)}))}},{key:"soredNodesWidthSeq",value:function(e,t){t.forEach((function(t){var r=D()(e,(function(e){return e.prop===t.prop}));r.length&&e.push(r[0])}))}},{key:"_findDeepestNodePath",value:function(){for(var e=this.getBFSNodes(),t=e[e.length-1],r=[];t&&t.parent;)r.unshift(t),t=t.parent;return r}},{key:"getBFSNodes",value:function(){for(var e=[],t=this.root.children.slice(),r=0;t[r];r++)e.push(t[r]),t[r].children&&t.push.apply(t,Object(v.a)(t[r].children));return e}},{key:"getNodeByProp",value:function(e,t){var r=null;return this.traverseDF((function(t){if(t.prop===e)return r=t,!0}),t),r}},{key:"getDFSNodes",value:function(){var e=N()(this.root);return this.traverseDF((function(e){e.clear()}),e),e.children}},{key:"traverseDF",value:function(e,t){var r=t||this.root;if(r){!function t(r){if(!e(r)&&r.children)for(var n=0;n<r.children.length;n++)t(r.children[n])}(r)}}},{key:"getLeafNodes",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root.children,r=[];return t.forEach((function(t){t.children&&t.children.length?r.push.apply(r,Object(v.a)(e.getLeafNodes(t.children))):r.push(t)})),r}},{key:"getLastNode",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root,t=arguments.length>1?arguments[1]:void 0,r=e;r&&r.children.length;){var n=r.children.length;r=r.children[n-1],t&&t(r)}return r}},{key:"getDeepestNodeByIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.deepestNodePath.length-1;return this.deepestNodePath[e]}},{key:"sortSameLevelPos",value:function(e){if(this.sortingColumn&&this.sortingColumn.level!==e.level)return!1;var t=this.sortingColumn.parent;if(t!==e.parent)return!1;var r=t.children.indexOf(this.sortingColumn),n=t.children.indexOf(e);return t.children.splice(r,1),t.children.splice(n,0,this.sortingColumn),this.leafNodes=this.getLeafNodes(),!0}}]),e}(),L=(r(32),r(15)),P=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(e){var n;Object(l.a)(this,r),(n=t.call(this,e)).state={columns:[],rowGroup:[],rowTableColGroup:[],data:[],layout:{},rowHeaderWidth:0,colHeaderHeight:0,bodyWrapperHeight:0,columnHeader:[],rowHeader:[],gutterWidth:g(),scrollX:null,scrollY:null,forceHideYGutter:!1,lazyLoading:!1},n.handleScroll=function(){var e=Object(u.a)(n),t=e.bodyWrapper,r=e.colHeaderWrapper,o=e.rowHeaderWrapper,a=e.showRowHeader,i=e.tableBody;n.showColumnHeader&&(r.scrollLeft=t.scrollLeft),a&&(o.scrollTop=t.scrollTop),n.state.lazyLoading&&i.lazyRenderRows(n.lazyStartIndex)};var o=e.columnHeader,a=e.rowHeader,i=e.setting||{},c=i.r,s=i.c,d=i.co;return n.colHeaderTree=new T(o,s,d),n.rowHeaderTree=new T(a,c),n.cornerNode=new k({name:""}),n}return Object(c.a)(r,[{key:"getChildContext",value:function(){return{table:this}}}]),Object(c.a)(r,[{key:"bindRef",value:function(e){var t=this;return function(r){t[e]=r}}},{key:"scheduleLayout",value:function(){var e=this;this.calculateWidth(),this.forceUpdate((function(){e.calculateHeight(),e.updateScrollY(),e.state.lazyLoading&&e.tableBody.lazyRenderRows(e.lazyStartIndex)}))}},{key:"componentWillUpdate",value:function(){console.log("will update table")}},{key:"calculateWidth",value:function(){var e=this.state,t=e.columns,r=e.rowTableColGroup,n=e.gutterWidth,o=t.reduce((function(e,t){return e+(t.width||t.minWidth)}),0),a=this.tableEl.clientWidth;if(this.showRowHeader){var i=r.reduce((function(e,t){return e+(t.width||t.minWidth)}),0);this.state.rowHeaderWidth=i}else this.state.rowHeaderWidth=0;var l,c=t.filter((function(e){return"number"!==typeof e.width})),s=a-this.state.rowHeaderWidth;if(c.length)if(o<s-n){l=!1;var d=s-n-o;if(d>0)if(1===c.length)c[0].realWidth=c[0].minWidth+d;else{var h=d/c.reduce((function(e,t){return e+t.minWidth}),0),u=0;c.forEach((function(e,t){if(0!==t){var r=Math.floor(e.minWidth*h);u+=r,e.realWidth=e.minWidth+r}})),c[0].realWidth=c[0].minWidth+d-u}}else l=!0,c.forEach((function(e){e.realWidth=e.minWidth}));else l=o>s,t.forEach((function(e){return e.realWidth=e.width||e.minWidth})),s=o;this.state.colHeaderWidth=Math.max(o,s),this.state.scrollX=l,this.state.forceHideYGutter=this.state.colHeaderWidth<a-this.state.rowHeaderWidth}},{key:"calculateHeight",value:function(){var e=this;this.setState((function(t){var r,n=e.colHeaderWrapper;r=e.props.showColumnHeader?n.clientHeight:0;var o=e.props,a=o.height,i=o.maxHeight,l="100%";return a&&Object(L.isNumber)(a)&&(l=e.props.height-r),i&&Object(L.isNumber)(i)&&(l=e.props.maxHeight-r),e.cornerNode.height=r,{colHeaderHeight:r,bodyWrapperHeight:l}}))}},{key:"updateScrollY",value:function(){var e=this;this.setState((function(t){return{scrollY:e.bodyWrapper.querySelector(".dc-table-real-body").clientHeight>t.bodyWrapperHeight}}))}},{key:"getConfig",value:function(){var e=this.rowHeaderTree,t=this.colHeaderTree,r=this.props,n=this.tableWidth,o=r.height,a={},i={};return t.deepestNodePath.forEach((function(e){var t=e.prop,r=e.height,n=a[t];n||(n={}),n.height=r,a[t]=n})),t.leafNodes.forEach((function(e){var t=e.prop,r=e.width,n=a[t];n||(n={}),n.width=r,a[t]=n})),e.deepestNodePath.forEach((function(e){var t=e.prop,r=e.width,n=i[t];n||(n={}),n.width=r,i[t]=n})),e.leafNodes.forEach((function(e){var t=e.prop,r=e.height,n=i[t];n||(n={}),n.height=r,i[t]=n})),{w:n,h:o,c:a,co:t.getDFSNodes(),ro:e.getDFSNodes(),r:i}}},{key:"safeCallLayoutChange",value:function(){this.props.onLayoutChange&&this.props.onLayoutChange(this.getConfig())}},{key:"onLayoutChange",value:function(){this.scheduleLayout(),this.safeCallLayoutChange()}},{key:"refreshColumn",value:function(){var e=this,t=this.colHeaderTree.leafNodes,r=this.rowHeaderTree.leafNodes,n=m(this.colHeaderTree.root.children),o=b(this.rowHeaderTree.root.children);this.setState({columns:t,rowGroup:r,columnHeader:n,rowHeader:o},(function(){e.safeCallLayoutChange(),e.state.lazyLoading&&e.tableBody.lazyRenderRows(e.lazyStartIndex)}))}},{key:"refreshTable",value:function(e){var t=this.colHeaderTree.leafNodes,r=this.rowHeaderTree.leafNodes,n=this.rowHeaderTree.deepestNodePath,o=m(this.colHeaderTree.root.children),a=b(this.rowHeaderTree.root.children),i=!1;r.length*t.length>3e3&&(i=!0),this.setState({columns:t,rowGroup:r,rowTableColGroup:n,columnHeader:o,rowHeader:a,data:e,lazyLoading:i},this.scheduleLayout)}},{key:"componentDidMount",value:function(){var e=this.props.data;this.refreshTable(e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.columnHeader,r=e.rowHeader,n=e.data,o=e.setting;if(this.props.columnHeader!==t||this.props.rowHeader!==r||this.props.data!==n){var a=o||{},i=a.r,l=a.c,c=a.co,s=a.ro;this.colHeaderTree=new T(t,l,c),this.rowHeaderTree=new T(r,i,s),this.refreshTable(n)}}},{key:"render",value:function(){var e=this.state,t=e.rowHeaderWidth,r=e.colHeaderWidth,n=e.colHeaderHeight,a=this.props.className;return o.a.createElement("div",{ref:this.bindRef("tableEl"),className:"dc-table ".concat(a),style:Object.assign({width:this.tableWidth,overflow:"hidden"},this.tableHeight)},o.a.createElement("div",{style:{marginLeft:t},ref:this.bindRef("colBodyWrapper")},this.showColumnHeader&&o.a.createElement("div",{ref:this.bindRef("colHeaderWrapper"),className:"col-header-wrapper"},o.a.createElement(x,Object.assign({},this.props,{store:this.state,colHeaderWidth:r}))),o.a.createElement("div",{ref:this.bindRef("bodyWrapper"),style:this.bodyHeightOrMaxHeight,className:"body-wrapper",onScroll:this.handleScroll},o.a.createElement(W,Object.assign({ref:this.bindRef("tableBody")},this.props,{lazyLoading:this.state.lazyLoading,store:this.state,colHeaderWidth:r,rowsInView:Math.ceil(this.props.maxHeight/30),isNoData:this.isNoData})),this.isNoData&&o.a.createElement("div",{style:this.bodyHeightOrMaxHeight,className:"nodata-block"},o.a.createElement("div",{className:"nodata-text"},"No Data")))),this.showRowHeader&&o.a.createElement("div",{className:"row-header-wrapper",ref:this.bindRef("rowHeaderWrapper"),style:Object(h.a)({marginTop:n},this.bodyHeightOrMaxHeight)},o.a.createElement(R,Object.assign({},this.props,{store:this.state,tree:this.rowHeaderTree}))),this.showCorner&&o.a.createElement("div",{className:"corner-block",style:{width:t,height:n}},o.a.createElement("table",{border:"0",cellSpacing:"0",width:"100%"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement(C,{type:"corner",column:this.cornerNode}))))),o.a.createElement("div",{className:"dc-table-col-resize-proxy",ref:this.bindRef("colResizeProxy"),style:{visibility:"hidden"}}),o.a.createElement("div",{className:"dc-table-row-resize-proxy",ref:this.bindRef("rowResizeProxy"),style:{visibility:"hidden"}}))}},{key:"lazyStartIndex",get:function(){return Math.floor(this.bodyWrapper.scrollTop/30)}},{key:"tableWidth",get:function(){var e=this.props.width;return e>200?e:"100%"}},{key:"tableHeight",get:function(){var e=this.props,t=e.height,r=e.maxHeight,n={};return t?n.height=t||"":r&&(n.maxHeight=r),n}},{key:"bodyHeightOrMaxHeight",get:function(){var e=this.props,t=e.height,r=e.maxHeight,n=this.state.bodyWrapperHeight,o={};return t?o.height=n||"":r&&(o.maxHeight=n),o}},{key:"showCorner",get:function(){var e=this.props,t=e.showColumnHeader,r=e.showRowHeader,n=this.state,o=n.columns,a=n.rowGroup;return t&&r&&Boolean(o.length)&&Boolean(a.length)}},{key:"showRowHeader",get:function(){var e=this.props.showRowHeader,t=this.state.rowGroup;return e&&Boolean(t.length)}},{key:"showColumnHeader",get:function(){return this.props.showColumnHeader}},{key:"isNoData",get:function(){var e=this.state.data;return(!Array.isArray(e)||!e.length)&&!Object.keys(e).length}}]),r}(o.a.Component);P.defaultProps={border:1,width:100,setting:{},resizeWidth:!0,resizeHeight:!0,showColumnHeader:!0,showRowHeader:!0,sortSameLevelColumn:!1,useMapData:!1,data:[],columnHeader:[],rowHeader:[],className:""},P.childContextTypes={table:f.a.any};var I={rowHeader:[{name:"\u670d\u88c5",prop:"a",children:[{name:"\u4e0a\u8863",prop:"0",children:[]},{name:"\u5e3d\u5b50",prop:"1",children:[]},{name:"\u88e4\u5b50",prop:"2",children:[]},{prop:"3",name:"\u978b\u5b50",children:[]}]},{name:"\u7535\u5668",prop:"b",children:[{prop:"4",name:"\u51b0\u7bb1",children:[]},{prop:"5",name:"\u7535\u89c6",children:[]},{prop:"6",name:"\u7a7a\u8c03",children:[]},{name:"\u98ce\u6247",prop:"7",children:[]}]}],columnHeader:[{name:"2,018",prop:"2018",children:[{name:"Q1",prop:"2018-Q1",children:[]},{name:"Q2",prop:"2018-Q2",children:[]},{name:"Q3",prop:"2018-Q3",children:[]},{name:"Q4",prop:"2018-Q4",children:[]}]},{name:"2,019",prop:"2019",children:[{name:"Q1",prop:"2019-Q1",children:[]},{name:"Q2",prop:"2019-Q2",children:[]},{name:"Q3",prop:"2019-Q3",children:[]},{name:"Q4",prop:"2019-Q4",children:[]}]}],data:{0:{"2018-Q1":1,"2018-Q2":2,"2018-Q3":3,"2018-Q4":4,"2019-Q1":5,"2019-Q2":6,"2019-Q3":7,"2019-Q4":8},1:{"2018-Q1":2,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},2:{"2018-Q1":3,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},3:{"2018-Q1":4,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},4:{"2018-Q1":5,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},5:{"2018-Q1":6,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},6:{"2018-Q1":7,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},7:{"2018-Q1":8,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945}}},B=r(1),Y=function(){var e=Object(n.useContext)($),t=e.renderCell,r=e.cellWidth,a=void 0===r?120:r,i=e.cellHeight,l=void 0===i?40:i,c=e.dataAreaState,s=c.processedHeader,d=c.processedData,h=c.rowStartIndex;return d.map((function(e,r){return s.map((function(e,n){return o.a.createElement("div",{className:"cell",key:"d-a-".concat(r,"-").concat(n),style:{position:"absolute",top:(r+h)*l,left:e.left,width:e.width||a,height:l}},e.renderCell?e.renderCell(d[r][e.prop],r+h,e.prop,e):t(d[r][e.prop],r+h,e.prop,e))}))}))},A=function(){return!1};function X(e){var t=e.container,r=e.colResizeProxy,o=e.onResizeStop,a=Object(n.useRef)(!1),i=Object(n.useRef)(),l=Object(n.useRef)(),c=Object(n.useCallback)((function(e){var n=e.clientX-t.current.getBoundingClientRect().left;r.current.style.left=n+"px",document.body.style.cursor="col-resize"}),[r,t.current]),s=Object(n.useCallback)((function(e){r.current.style.visibility="hidden",document.body.style.cursor="",document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",s),a.current=!1,document.onselectstart=null,document.ondragstart=null;var t=e.clientX-l.current;o&&o(t,i.current)}),[r,c,o]);return{handleMouseMove:Object(n.useCallback)((function(e){if(!a.current){var t=e.currentTarget,r=t.getBoundingClientRect(),n=document.body.style;r.right-e.pageX<5?(n.cursor="col-resize",i.current=t.dataset.prop):(n.cursor="",i.current=null)}}),[]),handleMouseOut:Object(n.useCallback)((function(){document.body.style.cursor=""}),[]),handleMouseDown:Object(n.useCallback)((function(e){if(i.current){a.current=!0;var n=e.currentTarget,o=t.current.getBoundingClientRect().left,d=n.getBoundingClientRect().right-o;r.current.style.visibility="visible",r.current.style.left=d+"px",l.current=n.getBoundingClientRect().right,document.onselectstart=A,document.ondragstart=A,document.addEventListener("mousemove",c),document.addEventListener("mouseup",s)}}),[r,c,s,t])}}function G(){var e=document.createElement("div"),t=document.body||e;e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",e.style.overflow="scroll",t.appendChild(e);var r=e.offsetWidth,n=e.clientWidth;return t.removeChild(e),r-n}function U(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.reduce((function(e,r){return r.left=e,(r.width||t)+e}),0);return r?n:e}var F=function(){var e=Object(n.useContext)($),t=e.cellWidth,r=e.cellHeight,a=e.renderHeader,i=e.dataAreaState,l=e.setDataAreaState,c=e.tableRef,s=e.colResizeProxyRef,d=e.header,u=e.enableResize,p=i.processedHeader,f=X({container:c,colResizeProxy:s,onResizeStop:Object(n.useCallback)((function(e,r){var n=p.find((function(e){return e.prop===r}));if(n){n.width=Math.max((n.width||t)+e,30);var o=U(d,t,!0);l((function(e){return Object(h.a)({},e,{dataAreaWidth:o})}))}}),[p,l])}),v=f.handleMouseMove,g=f.handleMouseOut,m=f.handleMouseDown,b=Object(n.useMemo)((function(){return u?{onMouseMove:v,onMouseOut:g,onMouseDown:m}:{}}),[u,v,g,m]);return p.map((function(e,n){return o.a.createElement("div",Object.assign({key:"h-".concat(n),className:"header",style:{position:"absolute",width:e.width||t,height:r,left:e.left},"data-prop":e.prop},b),e.renderHeader?e.renderHeader(e,e.prop):a(e,e.prop))}))},_=(r(36),function(){var e=Object(n.useContext)($),t=e.cellWidth,r=e.cellHeight,a=e.dataAreaState,i=e.renderCell,l=a.processedData,c=a.rowStartIndex,s=a.fixedLeftCol;return l.map((function(e,n){return s.map((function(e,a){return o.a.createElement("div",{className:"cell fixed-left",key:"f-c-".concat(n,"-").concat(a),style:{position:"absolute",top:(n+c)*r,left:e.left,width:e.width||t,height:r}},e.renderCell?e.renderCell(l[n][e.prop],n+c,e.prop,e):i(l[n][e.prop],n+c,e.prop,e))}))}))}),V=function(){var e=Object(n.useContext)($),t=e.cellWidth,r=e.cellHeight,a=e.dataAreaState,i=e.renderHeader;return a.fixedLeftCol.map((function(e,n){return o.a.createElement("div",{key:"f-h-".concat(n),className:"header",style:{position:"absolute",left:e.left,width:e.width||t,height:r}},e.renderHeader?e.renderHeader(e,e.prop):i(e,e.prop))}))};function q(){var e=Object(n.useContext)($),t=e.header,r=e.data,a=e.scrollBarWidth,i=e.height,l=void 0===i?440:i,c=e.cellWidth,s=void 0===c?120:c,d=e.cellHeight,h=void 0===d?40:d,u=e.handleScroll,p=e.dataAreaRef,f=e.headerRef,v=e.fixedColLeftRef,g=e.colResizeProxyRef,m=e.tableRef,b=e.fixedLeftColWidth,y=e.preventScroll,w=e.enableResize,H=void 0===w||w,Q=e.dataAreaState.dataAreaWidth,O=r.length,j=t.length,E=Object(n.useMemo)((function(){return H?t.reduce((function(e,t){return e+(t.width||s)}),0):j*s}),[H,t,j,s]),C=Object(n.useMemo)((function(){return O*h}),[O,h]);return o.a.createElement("div",{ref:m,className:"cs-table",style:{position:"relative",height:l}},y&&o.a.createElement("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:2}}),o.a.createElement("div",{ref:f,style:{overflow:"hidden",marginLeft:b}},o.a.createElement("div",{style:{width:(Q||E)+a,position:"relative",height:h}},o.a.createElement(F,null))),!!b&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{style:{position:"absolute",width:b,top:0}},o.a.createElement(V,null)),o.a.createElement("div",{ref:v,style:{overflow:"hidden",height:l-h,width:b,position:"absolute",left:0}},o.a.createElement("div",{style:{height:C+a}},o.a.createElement(_,null)))),o.a.createElement("div",{ref:p,style:{position:"relative",overflow:"auto",marginLeft:b,height:l-h},onScroll:u},o.a.createElement("div",{style:{height:C,width:Q||E}},o.a.createElement(Y,null))),o.a.createElement("div",{className:"resize-col-proxy",ref:g,style:{visibility:"hidden"}}))}for(var J=function(e,t){var r=Object(n.useRef)(!1);Object(n.useEffect)((function(){if(r.current)return e();r.current=!0}),t)},$=o.a.createContext({}),K=function(e,t,r){for(var n=[],o=0;o<=r;o++){var a=e[t+o];a&&n.push(a)}return n},Z=function(e){var t=e.header,r=e.data,a=e.height,i=void 0===a?440:a,l=e.cellWidth,c=void 0===l?120:l,s=e.cellHeight,d=void 0===s?40:s,u=e.renderCell,p=void 0===u?function(e,t,r){return e}:u,f=e.renderHeader,v=void 0===f?function(e,t){return e.label}:f,g=e.children,m=e.preventScroll,b=void 0!==m&&m,y=e.enableResize,w=void 0!==y&&y,H=e.keepScrollStatus,Q=void 0!==H&&H,O=Object(n.useRef)(),j=Object(n.useRef)(),E=Object(n.useRef)(),C=Object(n.useRef)(G()),x=Object(n.useRef)(),R=Object(n.useRef)(),S=Object(n.useMemo)((function(){return U(t.filter((function(e){return!e.fixed})),c)}),[t,c]),W=Object(n.useMemo)((function(){return U(t.filter((function(e){return e.fixed})),c)}),[t,c]),k=Object(n.useRef)();k.current=b;var M=Object(n.useMemo)((function(){return W.reduce((function(e,t){return e+(t.width||c)}),0)}),[W,c]),N=Object(n.useRef)(Math.ceil((document.body.offsetWidth-M)/c)),z=Object(n.useRef)(Math.ceil(i/d)),D=Object(n.useState)((function(){return{processedHeader:K(S,0,N.current),processedData:K(r,0,z.current),fixedLeftCol:W,rowStartIndex:0,colStartIndex:0}})),T=Object(B.a)(D,2),L=T[0],P=T[1],I=Object(n.useRef)({colIndex:0,rowIndex:0,scrollTop:0,colCount:N.current,rowCount:z.current});J((function(){P((function(e){var n=e.processedData,o=e.processedHeader,a=e.fixedLeftCol,i=I.current,l=i.colIndex,c=i.rowIndex,s=i.colCount,d=i.rowCount,u=i.scrollTop;return n!==r&&(e.processedData=K(r,Q?c:0,d||z.current)),o!==t&&(e.processedHeader=K(S,Q?l:0,s||N.current)),a!==W&&(e.fixedLeftCol=W),Q?E.current&&E.current.scrollTo(0,u):(O.current&&O.current.scrollTo(0,0),E.current&&E.current.scrollTo(0,0)),Object(h.a)({},e)}))}),[r,S,W,Q]);var Y=Object(n.useCallback)((function(e){var t=e.currentTarget;if(t){var n,o,a=t.scrollLeft,i=t.scrollTop,l=t.offsetWidth,s=t.offsetHeight;if(w){var u=function(e,t,r,n){for(var o=0,a=0,i=e.length-1,l=t+r,c=0;c<e.length;c++)if((o+=e[c].width||n)<t&&(a=c),o>l){i=c;break}return{startIndex:a,count:i-a+1}}(S,a,O.current.offsetWidth,c),p=u.startIndex,f=u.count;n=p,o=f}else n=Math.floor(a/c),o=Math.ceil(l/c);var v=Math.floor(i/d),g=Math.ceil(s/d);j.current&&(j.current.scrollLeft=a),E.current&&(E.current.scrollTop=i);var m=I.current;if(m.colIndex!==n||m.rowIndex!==v){m.colIndex=n,m.rowIndex=v,m.colCount=o,m.rowCount=g,m.scrollTop=i;var b=K(S,n,o),y=K(r,v,g);P((function(e){return Object(h.a)({},e,{processedHeader:b,processedData:y,colStartIndex:n,rowStartIndex:v})}))}}}),[S,r,c,d,O,w]),A={header:S,data:r,height:i,scrollBarWidth:C.current,cellWidth:c,cellHeight:d,dataAreaRef:O,headerRef:j,fixedColLeftRef:E,colResizeProxyRef:x,tableRef:R,handleScroll:Y,dataAreaState:L,fixedLeftColWidth:M,setDataAreaState:P,preventScroll:k.current,renderCell:p,renderHeader:v,enableResize:w};return o.a.createElement($.Provider,{value:A},g)},ee=o.a.memo((function(e){return o.a.createElement(Z,e,o.a.createElement(q,null))})),te=[{label:"Operation",fixed:!0,prop:"op",width:90,renderHeader:function(e,t){return o.a.createElement("a",{href:"#"},"Operation")},renderCell:function(){return o.a.createElement("a",{href:"#"},"OP")}},{label:"Email (Fixed)",fixed:!0,prop:"email"}],re=0;re<10;re++)te.push({label:"H ".concat(re),prop:"".concat(re)});for(var ne=[],oe=0;oe<1e5;oe++){for(var ae={},ie=0;ie<10;ie++)ae[ie]="data ".concat(oe,":").concat(ie);ae.email="test_".concat(oe,"@email.com"),ne.push(ae)}var le=Object(n.memo)((function(){var e=Object(n.useState)(0),t=Object(B.a)(e,2),r=(t[0],t[1],Object(n.useState)(te)),a=Object(B.a)(r,2),i=a[0],l=(a[1],Object(n.useState)(ne)),c=Object(B.a)(l,2),s=c[0],d=(c[1],Object(n.useState)(!1)),h=Object(B.a)(d,2),u=h[0];h[1];return o.a.createElement("div",null,o.a.createElement("p",{style:{margin:23}}," 10 * 100000 (col * row)"),o.a.createElement(ee,{header:i,data:s,cellWidth:200,preventScroll:u,enableResize:!0}))}));function ce(e){for(var t=[],r=Object(v.a)(e),n=0;r[n];n++)t.push(r[n]),r.push.apply(r,Object(v.a)(r[n].children));return t}function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=1,o=Object(B.a)(t,2),a=o[0],i=o[1];function l(e,t){if(t?(r.calcTop&&(e.top=t.top+r.calcTop),r.calcLeft&&(e.left=t.left+r.calcLeft),e.level=t.level+1,e.parent=t,n<e.level&&(n=e.level)):(e.level=0,r.calcTop&&(e.top=0),r.calcLeft&&(e.left=0)),e.children.length){var o=0;e.children.forEach((function(t){l(t,e),o+=t[a]})),e[a]=o}else e[a]=1}e.forEach((function(e){l(e)}));for(var c=[],s=0;s<=n;s++)c.push([]);var d=ce(e);return d.forEach((function(e){e.children.length?e[i]=1:e[i]=n-e.level+1,c[e.level].push(e)})),{flattenRow:c,allColumns:d}}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.forEach((function(e){e.children&&e.children.length?t.push.apply(t,Object(v.a)(de(e.children))):(e.isLeaf=!0,t.push(e))})),t}function he(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=e[e.length-1],o=[];n;)n.height||(n.height=r),n.width||(n.width=t),o.unshift(n),n=n.parent;return o}function ue(e,t,r){var n=new Set;e.forEach((function(e){e[t]=e[t]||r;var o=e[t],a=e.parent;for(a&&!n.has(a)&&(a[t]=0,n.add(a));a;){var i=a[t]||0;a[t]=i+o,o=i+o,a=a.parent}}))}function pe(e,t,r){for(var n=0,o=e.length;n<o;n++)for(var a=0,i=0,l=e[n].length;i<l;i++){var c=e[n][i];a=0===a?c.parent?c.parent[t]:0:a,c[t]=a,a+=c[r]}}function fe(e,t,r){for(var n="width"===r?"left":"top",o=0,a=e.length;o<a;o++){var i=e[o],l=i.rowSpan,c=i.colSpan,s=i.level;if(-1===t.indexOf(e[o])){i[n]=t[i.level][n],e[o][r]=0;for(var d=s,h=("height"===r?l:c)+s;d<h;d++)e[o][r]+=t[d][r]}}}function ve(e,t,r){var n=0,o=Math.floor(t.length/2),a=t.length;if(t.length&&t[0][r]>e)return n;for(var i="width"===r?"left":"top";a-n>1;)t[o][i]<e&&(n=o),t[o][i]>=e&&(a=o),o=Math.floor((n+a)/2);return n}function ge(e,t,r,n){for(var o=0,a=[],i=[],l=n+30,c=e,s=t.length;c<s&&(o+=t[c][r],i.push(t[c]),!(o>l));c++);var d=new Set;return i.forEach((function(e){for(;e.parent&&!d.has(e.parent);)a.push(e.parent),d.add(e.parent)})),[].concat(a,i)}function me(e,t){for(var r=null,n=function e(n){if(n.prop===t)return r=n,!0;n.children&&n.children.forEach((function(t){e(t)}))},o=0,a=e.length;o<a&&!n(e[o]);o++);return r}function be(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function ye(e){var t=e.colHeader,r=e.cellWidth,o=e.cellHeight,a=Object(n.useRef)(t),i=function(){var e=Object(n.useState)(0),t=Object(B.a)(e,2),r=t[0],o=t[1];return{updateCount:r,forceUpdate:Object(n.useCallback)((function(){o((function(e){return e+1}))}),[o])}}(),l=i.forceUpdate,c=i.updateCount,s=Object(n.useMemo)((function(){return se(a.current,["colSpan","rowSpan"],{calcTop:o})}),[a.current,c]),d=s.flattenRow,u=s.allColumns,p=Object(n.useCallback)((function(){var e=de(a.current);ue(e,"width",r),pe(d,"left","width");var t=he(u,r,o);return fe(u,t,"height"),{colHeaderHeight:t.reduce((function(e,t){return e+t.height}),0),colHeaderWidth:e.reduce((function(e,t){return e+t.width}),0),colHeaderLeaf:e}}),[a.current,d,u]),f=Object(n.useState)((function(){return p()})),v=Object(B.a)(f,2),g=v[0],m=v[1],b=Object(n.useCallback)((function(e,t){(function(e,t,r){var n=me(e,t),o=me(e,r);if(!n||!o)return console.warn("Can not find node."),!1;if(n.parent!==o.parent)return console.warn("Can not switch nodes, because it has diff parent."),!1;if(n.parent){var a=n.parent.children,i=a.indexOf(n),l=a.indexOf(o);be(a,i,l)}else{var c=e.indexOf(n),s=e.indexOf(o);be(e,c,s)}return!0})(a.current,e,t)&&l()}),[a.current,l]),y=Object(n.useCallback)((function(){m(p())}),[p,m]);return J((function(){0!==c&&y()}),[c,y]),Object(h.a)({colHeader:u,rebuildColHeader:y},g,{handleColSort:b})}var we=function(e){var t,r=e.header,a=e.resizeProps,i=e.dragParentRef,l=e.handleColSort,c=e.enableSorting,s=r.top,d=r.left,u=r.width,p=r.height,f=r.prop,v=r.label,g=function(e){var t=Object(n.useRef)(e);return t.current=e,Object(n.useCallback)((function(e){return{key:JSON.stringify(e),draggable:"true",onDragStart:function(r){t.current.handleDrag&&t.current.handleDrag(e),r.dataTransfer.setData("dragProp",e)}}}),[t])}({handleDrag:function(){var e;i.current=null===(e=r.parent)||void 0===e?void 0:e.prop}}),m=function(e){var t=Object(n.useRef)(e);t.current=e;var r=Object(n.useState)(""),o=Object(B.a)(r,2),a=o[0],i=o[1];return{dropProps:Object(n.useMemo)((function(){return{onDrop:function(e){e.preventDefault(),e.persist(),t.current.handleDrop&&t.current.handleDrop(e.dataTransfer.getData("dragProp"),e.currentTarget.dataset.prop||"")},onDragEnter:function(e){e.preventDefault(),console.log("on drag enter\uff1a",e.currentTarget.dataset.parentProp),i(e.currentTarget.dataset.parentProp)},onDragLeave:function(e){console.log("on drag leave",e.currentTarget.dataset.prop),i("")},onDragOver:function(e){e.preventDefault()}}}),[t,i]),hoverProp:a,setHoverProp:i}}({handleDrop:function(e,t){e!==t&&l(e,t),i.current="UNDEFINED_SHEET",w("")}}),b=m.dropProps,y=m.hoverProp,w=m.setHoverProp,H=Object(n.useMemo)((function(){return c?Object(h.a)({},g(f),{},b):{}}),[f]);return y!==i.current&&console.log(y,i.current),o.a.createElement("div",Object.assign({className:"header",style:{position:"absolute",top:s,left:d,width:u,height:p,outline:y===i.current?"2px dashed green":"none",outlineOffset:-2},"data-prop":f,"data-parent-prop":null===(t=r.parent)||void 0===t?void 0:t.prop},H,a),v)};function He(e){var t=e.dynColHeader,r=e.colHeaderWidth,a=e.colHeaderHeight,i=e.enableColResize,l=e.enableRowResize,c=e.containerRef,s=e.colResizeProxyRef,d=e.onUpdate,h=e.handleColSort,u=e.enableColSorting,p=X({container:c,colResizeProxy:s,onResizeStop:Object(n.useCallback)((function(e,r){var n=t.find((function(e){return e.prop===r}));n.isLeaf||(n=function(e){for(var t=e;t&&t.children.length;){var r=t.children.length;t=t.children[r-1]}return t}(n)),n&&e&&(n.width=Math.max(n.width+e,30)),d&&d()}),[t])}),f=p.handleMouseMove,v=p.handleMouseOut,g=p.handleMouseDown,m=Object(n.useMemo)((function(){return i||l?{onMouseMove:f,onMouseOut:v,onMouseDown:g}:{}}),[i,l,f,v,g]),b=Object(n.useRef)("UNDEFINED_SHEET");return o.a.createElement("div",{style:{position:"relative",height:a,width:r+G()}},t.map((function(e){return o.a.createElement(we,{key:e.prop,header:e,resizeProps:m,dragParentRef:b,handleColSort:h,enableSorting:u})})))}function Qe(e){var t=e.dynRowHeader,r=e.rowHeaderWidth,a=e.rowHeaderHeight,i=e.rowDeepestPath,l=e.enableColResize,c=e.enableRowResize,s=e.containerRef,d=e.colResizeProxyRef,h=e.onUpdate,u=(e.enableSorting,X({container:s,colResizeProxy:d,onResizeStop:Object(n.useCallback)((function(e,r){var n=t.find((function(e){return e.prop===r}));(n=i[n.level])&&e&&(n.width=Math.max(n.width+e,30)),h&&h()}),[t,i])})),p=u.handleMouseMove,f=u.handleMouseOut,v=u.handleMouseDown,g=Object(n.useMemo)((function(){return l||c?{onMouseMove:p,onMouseOut:f,onMouseDown:v}:{}}),[l,c,p,f,v]);return o.a.createElement("div",{style:{position:"relative",height:a+ +G(),width:r}},t.map((function(e){var t=e.top,r=e.left,n=e.width,a=e.height,i=e.label,l=e.prop;return o.a.createElement("div",Object.assign({className:"header",key:l,style:{position:"absolute",top:t,left:r,width:n,height:a},"data-prop":l},g),i)})))}var Oe=function(e){var t=e.colHeader,r=e.rowHeader,a=e.data,i=e.height,l=void 0===i?400:i,c=e.width,s=void 0===c?800:c,d=e.cellHeight,u=void 0===d?40:d,p=e.cellWidth,f=void 0===p?100:p,v=e.renderCell,g=void 0===v?function(e,t,r,n){return e}:v,m=e.enableColResize,b=void 0!==m&&m,y=e.enableRowResize,w=void 0!==y&&y,H=e.enableColSorting,Q=void 0!==H&&H,O=e.enableRowSorting,j=void 0!==O&&O,E=ye({colHeader:t,cellWidth:f,cellHeight:u}),C=E.colHeaderWidth,x=E.colHeaderHeight,R=E.colHeaderLeaf,S=E.rebuildColHeader,W=E.handleColSort,k=function(e){var t=e.rowHeader,r=e.cellWidth,o=e.cellHeight,a=Object(n.useMemo)((function(){return se(t,["rowSpan","colSpan"],{calcLeft:r})}),[]),i=a.flattenRow,l=a.allColumns,c=Object(n.useCallback)((function(){var e=de(t);ue(e,"height",o),pe(i,"top","height");var n=he(l,r,o);return function(e,t){var r="width"===t?"left":"top";e.reduce((function(e,n){return n[r]=e,e+n[t]}),0)}(n,"width"),fe(l,n,"width"),{rowHeaderWidth:n.reduce((function(e,t){return e+t.width}),0),rowHeaderHeight:e.reduce((function(e,t){return e+t.height}),0),rowHeaderLeaf:e,rowDeepestPath:n}}),[t,i,l]),s=Object(n.useState)((function(){return c()})),d=Object(B.a)(s,2),u=d[0],p=d[1],f=Object(n.useCallback)((function(){p(c())}),[c,p]);return Object(h.a)({rowHeader:l,rebuildRowHeader:f},u)}({rowHeader:r,cellWidth:f,cellHeight:u}),M=k.rowHeaderWidth,N=k.rowHeaderHeight,z=k.rowHeaderLeaf,D=k.rebuildRowHeader,T=k.rowDeepestPath,L=Object(n.useRef)(),P=Object(n.useRef)(),I=Object(n.useRef)(),Y=Object(n.useRef)(),A=Object(n.useRef)(),X=Object(n.useState)((function(){return{dynColHeader:ge(0,R,"width",s),dynRowHeader:ge(0,z,"height",l)}})),G=Object(B.a)(X,2),U=G[0],F=U.dynColHeader,_=U.dynRowHeader,V=G[1],q=Object(n.useRef)({colIndexCache:0,rowIndexCache:0}),$=Object(n.useCallback)((function(e){var t=e.currentTarget;if(t){var r=t.scrollTop,n=t.scrollLeft,o=t.clientHeight,a=t.clientWidth;Y.current.scrollLeft=n,I.current.scrollTop=r;var i,l,c=q.current,s=c.colIndexCache,d=c.rowIndexCache,h=ve(n,R,"width"),u=ve(r,z,"height");if(s!==h||d!==u)s!==h&&(i=ge(h,R,"width",a),q.current.colIndexCache=h),d!==u&&(l=ge(u,z,"height",o),q.current.rowIndexCache=u),V((function(e){return{dynColHeader:i||e.dynColHeader,dynRowHeader:l||e.dynRowHeader}}))}}),[V,R]);return J((function(){var e=q.current,t=e.colIndexCache,r=e.rowIndexCache,n=ge(t,R,"width",s),o=ge(r,z,"height",l);V((function(e){return{dynColHeader:n||e.dynColHeader,dynRowHeader:o||e.dynRowHeader}}))}),[R,z,s,l]),o.a.createElement("div",{className:"cs-sheet",style:{height:l,position:"relative"},ref:L},o.a.createElement("div",{className:"corner",style:{height:x,width:M,position:"absolute"}}),o.a.createElement("div",{className:"cs-sheet-col-header",style:{marginLeft:M,overflow:"hidden"},ref:Y},o.a.createElement(He,{dynColHeader:F,colHeaderHeight:x,colHeaderWidth:C,containerRef:L,colResizeProxyRef:A,enableColResize:b,enableRowResize:w,enableColSorting:Q,onUpdate:S,handleColSort:W})),o.a.createElement("div",{className:"cs-sheet-row-header",style:{overflow:"hidden",height:l-x},ref:I},o.a.createElement(Qe,{dynRowHeader:_,rowDeepestPath:T,rowHeaderHeight:N,rowHeaderWidth:M,containerRef:L,colResizeProxyRef:A,enableColResize:b,enableRowResize:w,enableRowSorting:j,onUpdate:D})),o.a.createElement("div",{style:{position:"absolute",top:x,left:M,bottom:0,right:0,overflow:"auto"},onScroll:$,ref:P},o.a.createElement("div",{style:{width:C,height:N}},z.map((function(e,t){return R.map((function(r,n){return o.a.createElement("div",{className:"cell",key:"d-a-".concat(t,"-").concat(n),style:{position:"absolute",width:r.width,height:e.height,left:r.left,top:e.top}},g(a[e.prop][r.prop],e.prop,r.prop,a))}))})))),o.a.createElement("div",{className:"resize-col-proxy",ref:A,style:{visibility:"hidden"}}))};var je=function(e){var t=function(){var e=Object(n.useState)({width:0,height:0}),t=Object(B.a)(e,2),r=t[0],o=t[1],a=Object(n.useRef)();return Object(n.useLayoutEffect)((function(){var e=a.current,t=e.clientHeight,r=e.clientWidth;o({width:r,height:t})}),[]),[r,a]}(),r=Object(B.a)(t,2),a=r[0],i=r[1],l=a.width,c=a.height;return o.a.createElement("div",{ref:i,style:{height:"100%",width:"100%"}},!!l&&!!c&&o.a.createElement(Oe,Object.assign({},e,{width:l,height:c})))},Ee=[{label:"\u5e7f\u4e1c",prop:"gd",children:[{label:"\u5e7f\u5dde",prop:"gd-gz",children:[]},{label:"\u4f5b\u5c71",prop:"gd-fs",children:[]},{label:"\u73e0\u6d77",prop:"gd-zh",children:[]},{label:"\u4e1c\u839e",prop:"gd-dg",children:[]}]},{label:"\u6c5f\u82cf",prop:"js",children:[{label:"\u5357\u4eac",prop:"js-nj",children:[]},{label:"\u65e0\u9521",prop:"js-wx",children:[]},{label:"\u5f90\u5dde",prop:"js-xz",children:[]},{label:"\u5e38\u5dde",prop:"js-cz",children:[]}]},{label:"\u5c71\u4e1c",prop:"sd",children:[{label:"\u6d4e\u5357",prop:"sd-jning",children:[]},{label:"\u9752\u5c9b",prop:"sd-qd",children:[]},{label:"\u70df\u53f0",prop:"sd-yt",children:[]},{label:"\u6d4e\u5b81",prop:"sd-jn",children:[]}]},{label:"\u6d59\u6c5f",prop:"zj",children:[{label:"\u676d\u5dde",prop:"zj-hz",children:[]},{label:"\u5b81\u6ce2",prop:"zj-nb",children:[]},{label:"\u6e29\u5dde",prop:"zj-wz",children:[]},{label:"\u7ecd\u5174",prop:"zj-zx",children:[]}]}],Ce=[{label:"2018",prop:"2018",children:[{label:"Q1",prop:"2018-Q1",children:[]},{label:"Q2",prop:"2018-Q2",children:[]},{label:"Q3",prop:"2018-Q3",children:[]},{label:"Q4",prop:"2018-Q4",children:[]}]},{label:"2019",prop:"2019",children:[{label:"Q1",prop:"2019-Q1",children:[]},{label:"Q2",prop:"2019-Q2",children:[]},{label:"Q3",prop:"2019-Q3",children:[]},{label:"Q4",prop:"2019-Q4",children:[]}]},{label:"2020",prop:"2020",children:[{label:"Q1",prop:"2020-Q1",children:[]},{label:"Q2",prop:"2020-Q2",children:[]},{label:"Q3",prop:"2020-Q3",children:[]},{label:"Q4",prop:"2020-Q4",children:[]}]},{label:"2021",prop:"2021",children:[{label:"Q1",prop:"2021-Q1",children:[]},{label:"Q2",prop:"2021-Q2",children:[]},{label:"Q3",prop:"2021-Q3",children:[]},{label:"Q4",prop:"2021-Q4",children:[]}]}],xe={"gd-gz":{"2018-Q1":1,"2018-Q2":2,"2018-Q3":3,"2018-Q4":4,"2019-Q1":5,"2019-Q2":6,"2019-Q3":7,"2019-Q4":8},"gd-fs":{"2018-Q1":2,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"gd-zh":{"2018-Q1":3,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"gd-dg":{"2018-Q1":4,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"js-nj":{"2018-Q1":5,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"js-wx":{"2018-Q1":6,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"js-xz":{"2018-Q1":7,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"js-cz":{"2018-Q1":8,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"sd-jning":{"2018-Q1":8,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"sd-qd":{"2018-Q1":8,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"sd-yt":{"2018-Q1":8,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"sd-jn":{"2018-Q1":8,"2018-Q2":3244,"2018-Q3":4903,"2018-Q4":8903,"2019-Q1":5423,"2019-Q2":4567,"2019-Q3":8976,"2019-Q4":1945},"zj-hz":{},"zj-nb":{},"zj-wz":{},"zj-zx":{}},Re=function(){var e=Ee,t=Ce,r=xe;return o.a.createElement("div",null,o.a.createElement("div",{style:{height:400}},o.a.createElement(je,{rowHeader:e,colHeader:t,data:r,cellWidth:120,cellHeight:44,enableColResize:!0,enableColSorting:!0})))},Se=function(e){Object(s.a)(r,e);var t=Object(d.a)(r);function r(){var e;Object(l.a)(this,r);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={rowHeader:I.rowHeader,columnHeader:I.columnHeader,data:I.data},e}return Object(c.a)(r,[{key:"render",value:function(){var e=this.state;e.columnHeader,e.rowHeader,e.data;return o.a.createElement("div",{className:"App"},o.a.createElement("h1",null,"High performance table"),o.a.createElement("div",{style:{margin:15}},o.a.createElement(le,null)),o.a.createElement("h1",null,"Sheet"),o.a.createElement("div",{style:{margin:15}},o.a.createElement(Re,null)))}}]),r}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(Se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[22,1,2]]]);
//# sourceMappingURL=main.3e034037.chunk.js.map