{"version":3,"sources":["component/util.js","component/Draggable.js","component/Th.js","component/TableColumnHeader.js","component/TableRowHeader.js","component/TableBody.js","component/node.js","component/tree.js","component/Table.js","component/index.js","data.js","table/DataArea.js","hooks/useResize.js","table/util.js","table/Header.js","table/FixedLeftColumn.js","table/FixedLeftHeader.js","table/CSTable.js","table/demo/demo1.js","hooks/useUpdateEffect.js","table/index.js","sheet/util.js","sheet/useColHeader.js","hooks/useForceUpdate.ts","hooks/useDragAndDrop.ts","sheet/HeaderCell.tsx","sheet/ColHeader.js","sheet/RowHeader.js","sheet/index.js","sheet/useRowHeader.js","sheet/AutoSize.js","hooks/useSize.js","sheet/demo/data.js","sheet/demo/demo1.js","App.js","serviceWorker.js","index.js"],"names":["getScrollBarWidth","dom","document","createElement","body","style","visibility","width","position","top","overflow","appendChild","totalWidth","offsetWidth","widthWithoutScroll","clientWidth","removeChild","convertToColumnHeader","columns","maxLevel","traverse","column","parent","level","children","length","colSpan","forEach","subColumn","rows","i","push","allColumns","queue","slice","rowSpan","convertToRowHeader","rowsLength","child","posCount","offset","start","ascId","getAscId","matchesFun","isMatchSelector","el","selector","f","Draggable","props","state","mouseDown","dragging","onMouseDown","bind","onMouseMove","onMouseUp","e","button","domNode","findDOMNode","this","handle","rootDom","node","parentNode","matchsSlelector","target","addEvent","pageOffset","getBoundingClientRect","height","left","setState","originX","pageX","originY","pageY","elementX","elementY","deltaX","deltaY","distance","Math","abs","onDragStart","dragData","prestate","pos","computedLeft","scrollLeft","computedTop","scrollTop","axis","removeEvent","onDragStop","onselectstart","ondragstart","addEventListener","removeEventListener","callback","opacity","zIndex","className","React","Component","defaultProps","Th","handleMouseDown","type","draggingColumn","table","context","tableEl","colResizeProxy","rowResizeProxy","tableRect","tableLeft","tableTop","thEl","tagName","thRect","minLeft","minTop","startMouseLeft","clientX","startMouseTop","clientY","startLeft","right","direction","startTop","bottom","handleMouseMove","event","deltaLeft","proxyLeft","max","deltaTop","proxyTop","handleMouseUp","targetNode","headerTree","getLastNode","index","getDeepestNodeByIndex","rowHeaderTree","calWidth","realWidth","minWidth","offsetHeight","colHeaderTree","calHeight","cursor","onLayoutChange","scheduleLayout","sortingColumn","rect","bodyStyle","disableResizeCol","disableResizeRow","handleMouseOut","onMouseEnter","sortSameLevelPos","refreshColumn","handleSortStart","handleSortStop","setTimeout","name","fn","args","sortSameLevelColumn","onMouseOut","classnames","leaf","computedHeight","resizeWidth","resizeHeight","contextTypes","PropTypes","any","TableRowHeader","colHeaderWidth","store","columnHeader","border","cellPadding","cellSpacing","borderBottom","map","prop","key","rs","c","gutterWidth","forceHideYGutter","scrollY","tree","rowTableColGroup","rowHeader","rowHeaderWidth","scrollX","deepestNodePath","TableBody","recordsInView","offsetIndex","lazyRenderRows","throttle","showRowHeader","rowGroup","data","isNoData","row","rowIndex","getCellHeight","rowsInView","rowHeaderItem","rowProp","lazyLoading","transform","getLazyData","getMapData","Node","field","minHeight","undefined","Tree","setting","sorting","leafNodes","root","buildTree","_initTree","_findDeepestNodePath","getLeafNodes","savedConfig","Object","assign","currentNode","addChild","item","_traverse","Date","getTime","mockCloneData","cloneDeep","mockData","mockSorted","traverseDF","dataNode","getNodeByProp","sortedNode","soredNodesWidthSeq","end","console","log","source","dest","tempEl","remove","allNodes","getBFSNodes","dn","deepestPath","unshift","n","rootNode","clear","cb","pNode","recurse","nodes","result","tn","l","rep","sortingIndex","indexOf","rIndex","splice","Table","layout","colHeaderHeight","bodyWrapperHeight","handleScroll","bodyWrapper","colHeaderWrapper","rowHeaderWrapper","tableBody","showColumnHeader","lazyStartIndex","r","co","cornerNode","calculateWidth","forceUpdate","calculateHeight","updateScrollY","bodyMinWidth","reduce","acc","col","tableElWidth","flexColumns","filter","bodyWidth","totalFlexWidth","flexWidthPerPixel","pre","widthWithoutFirst","flexWidth","floor","clientHeight","maxHeight","isNumber","querySelector","tableWidth","colConfig","rowConfig","cell","w","h","getDFSNodes","ro","getConfig","safeCallLayoutChange","refreshTable","ref","bindRef","tableHeight","marginLeft","bodyHeightOrMaxHeight","onScroll","ceil","marginTop","showCorner","Boolean","Array","isArray","keys","useMapData","childContextTypes","0","1","2","3","4","5","6","7","useContext","CSTableContext","renderCell","cellWidth","cellHeight","dataAreaState","header","processedHeader","processedData","rowStartIndex","_","colIndex","returnFalse","useResize","container","onResizeStop","isDraggingRef","useRef","draggingCol","startPosRef","handleResizeStart","useCallback","movedDistance","current","handleResizeStop","currHeader","currentTarget","dataset","currTarget","containLeft","startPos","processHeaderWidth","defaultCellWidth","returnTotalWidth","curr","renderHeader","setDataAreaState","tableRef","colResizeProxyRef","allHeader","enableResize","draggingProp","currH","find","dataAreaWidth","prev","resizeProps","useMemo","data-prop","fixedLeftCol","CSTable","scrollBarWidth","dataAreaRef","headerRef","fixedColLeftRef","fixedLeftColWidth","preventScroll","areaWidthAfterResize","rowCount","colCount","areaWidth","areaHeight","Header","FixedLeftHeader","FixedLeftColumn","DataArea","fnc","deps","isMountRef","useEffect","createContext","getRangeFromArr","arr","count","res","record","Provider","label","keepScrollStatus","scrollBarRef","restHeader","fixed","fixedLeft","preventScrollRef","initWidthCountRef","initHeightCountRef","useState","colStartIndex","scrollStatusCacheRef","useUpdateEffect","preState","preData","preHeader","preFixedLeftCol","scrollTo","cellTarget","colRenderCount","sLeft","sTop","oWidth","oHeight","scrollWidth","accWidth","startIndex","endIndex","getMutableIndexAndCount","rowRenderCount","scrollStatus","prevState","editorContext","value","memo","p","href","d","margin","falttenTree","processTree","spanSeq","opts","firstSpan","secondSpan","calcTop","calcLeft","span","flattenRow","isLeaf","getDeepestNodePath","allNode","travelToRootFromLeafNodes","defaultValue","set","Set","accValue","has","add","parentProp","calcNodeOffsetFormFalttenHeader","measure","iLength","j","jLength","calcMeasureFromDeepestPath","offsetType","binSearch","scroll","mid","getSubTreeFromStartNode","measuerLength","parentHeaderInView","subLeafNode","safeLength","ws","rawHeader","foundNode","recursion","cn","switchNode","fIndex","sIndex","t","useColHeader","colHeader","rawHeaderRef","updateCount","update","useForceUpdate","buildHeaderTree","colHeaderLeaf","setMeasure","handleColSort","p1","p2","firstProp","secondProp","firstNode","secondNode","warn","switchPosByProps","rebuildColHeader","dragParentRef","enableSorting","getDragProps","optsRef","JSON","stringify","draggable","handleDrag","dataTransfer","setData","useDrag","hoverProp","setHoverProp","dropProps","onDrop","preventDefault","persist","handleDrop","getData","onDragEnter","onDragLeave","onDragOver","useDrop","dragProp","dropProp","sortingProps","outline","outlineOffset","data-parent-prop","ColHeader","dynColHeader","enableColResize","enableRowResize","containerRef","onUpdate","enableColSorting","HeaderCell","RowHeader","dynRowHeader","rowHeaderHeight","rowDeepestPath","colProp","enableRowSorting","calcDeepsetNodePathOffset","rowHeaderLeaf","rebuildRowHeader","useRowHeader","sheetRef","rowHeaderRef","colHeaderRef","cacheRef","colIndexCache","rowIndexCache","newCol","newRow","currColIndex","currRowIndex","domRef","useLayoutEffect","useSize","simpleData","AutoSize","App","window","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.3e034037.chunk.js","sourcesContent":["export function getColHeaderHeightIndex(node) {\n  return node.level + node.rowSpan - 2\n}\n\nlet scrollBarWidth;\nexport function getScrollBarWidth() {\n  if (scrollBarWidth !== undefined) return scrollBarWidth;\n  const dom = document.createElement('div');\n  const body = document.body || dom;\n\n  dom.style.visibility = 'hidden';\n  dom.style.width = '100px';\n  dom.style.position = 'absolute';\n  dom.style.top = '-9999px';\n  dom.style.overflow = 'scroll';\n\n  body.appendChild(dom);\n\n  const totalWidth = dom.offsetWidth;\n  const widthWithoutScroll = dom.clientWidth;\n\n  body.removeChild(dom);\n\n  return totalWidth - widthWithoutScroll;\n}\n\nexport function convertToColumnHeader(columns = []) {\n  let maxLevel = 1;\n\n  function traverse(column, parent) {\n    if (parent) {\n      column.level = parent.level + 1;\n      if (maxLevel < column.level) {\n        maxLevel = column.level;\n      }\n    } else {\n      column.level = 1;\n    }\n\n    if (column.children.length) {\n      let colSpan = 0;\n      column.children.forEach((subColumn) => {\n        traverse(subColumn, column);\n        colSpan += subColumn.colSpan;\n      });\n      column.colSpan = colSpan;\n    } else {\n      column.colSpan = 1;\n    }\n  }\n\n  columns.forEach((column) => {\n    traverse(column);\n  });\n\n  const rows = [];\n  for (let i = 0; i < maxLevel; i++) {\n    rows.push([]);\n  }\n\n  const allColumns = [];\n  const queue = columns.slice();\n  for (let i = 0; queue[i]; i++) {\n    allColumns.push(queue[i]);\n    if (queue[i].children.length) queue.push(...queue[i].children);\n  }\n\n  allColumns.forEach((column) => {\n    if (!column.children.length) {\n      column.rowSpan = maxLevel - column.level + 1;\n    } else {\n      column.rowSpan = 1;\n    }\n    rows[column.level - 1].push(column);\n  });\n  return rows;\n  \n}\n\nexport function convertToRowHeader(columns = []) {\n  let maxLevel = 1;\n  let rowsLength = 0;\n\n  function traverse(column, parent) {\n    if (parent) {\n      column.level = parent.level + 1;\n      if (maxLevel < column.level) {\n        maxLevel = column.level;\n      }\n    } else {\n      column.level = 1;\n    }\n\n    // 计算 row span 以及计算有几个 叶子\n    if (column.children.length > 0) {\n      let rowSpan = 0;\n      column.children.forEach((child) => {\n        traverse(child, column);\n        rowSpan += child.rowSpan;\n      });\n      column.rowSpan = rowSpan;\n    } else {\n      column.rowSpan = 1;\n      return rowsLength++;\n    }\n  }\n\n  columns.forEach((column) => {\n    traverse(column);\n  });\n\n  let rows = []\n  for(let i = 0; i < rowsLength; i++) {\n    rows.push([]);\n  };\n\n  // 记录位置 index\n  const posCount = {};\n  for(let i = 1; i <= maxLevel; i++) {\n    posCount[i] = 0;\n  }\n\n  const allColumns = [];\n  const queue = columns.slice();\n  for (let i = 0; queue[i]; i++) {\n    allColumns.push(queue[i]);\n    if (queue[i].children) queue.push(...queue[i].children);\n  }\n\n  // 计算 col span, \n  allColumns.forEach((column) => {\n    if (column.children.length === 0) {\n      column.colSpan = maxLevel - column.level + 1;\n    } else {\n      column.colSpan = 1;\n    }\n  });\n\n\n  allColumns.forEach(column => {\n    const { rowSpan, level } = column;\n    // 如果占用了位置 则添加 offset\n    let offset = 0; \n    column.start = posCount[level];\n    if (column.parent && column.parent.start > column.start) {\n      offset += column.parent.start - column.start;\n      column.start += offset;\n    }\n    posCount[level] += offset;\n    rows[posCount[level]].push(column);\n    posCount[level] += rowSpan;\n  });\n  return rows;\n}\n\nexport function getLeafColumns(columns) {\n  const result = [];\n  columns.forEach((column) => {\n    if (column.children) {\n      result.push(...getLeafColumns(column.children));\n    } else {\n      result.push(column);\n    }\n  });\n  return result;\n}\n\nlet ascId = 0;\nexport function getAscId(){\n  return ascId++;\n}\n\nlet matchesFun = '';\nfunction isMatchSelector(el, selector) {\n  if (!matchesFun) {\n    [\n      'matches',\n      'webkitMatchesSelector',\n      'mozMatchesSelector',\n      'msMatchesSelector',\n      'oMatchesSelector',\n    ].forEach(f => {\n      if (typeof el[f] === 'function') {\n        matchesFun = f;\n      }\n    });\n  }\n  return el[matchesFun](selector);\n}\n\nexport function matchsSlelector(el, selector, rootDom) {\n  let node = el;\n  while(node) {\n    if (isMatchSelector(el, selector)) return true;\n    if (node === rootDom) return false;\n    node = node.parentNode;\n  }\n  return false;\n}\n\nexport const isNumber = val => typeof val === 'number';\n","import React from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { matchsSlelector } from './util';\nconst DRAG_THRESHOLD = 2;\n\nexport default class Draggable extends React.Component {\n\n  static defaultProps = {\n    axis: 'none',\n    handle: null,\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      mouseDown: false,\n      dragging: false\n    };\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n  }\n\n  onMouseDown(e) {\n    // left button\n    if(e.button === 0) {\n      //e.stopPropagation();\n      const domNode = findDOMNode(this);\n      const { handle } = this.props;\n      if (handle && !matchsSlelector(e.target, handle, domNode)) {\n        return;\n      }\n      this.addEvent();\n      const pageOffset = findDOMNode(this).getBoundingClientRect();\n      const { width, height, left, top } = pageOffset;\n      this.setState({\n        mouseDown: true,\n        originX: e.pageX,\n        originY: e.pageY,\n        elementX: left,\n        elementY: top,\n        width,\n        height\n      });\n    }\n  }\n\n  onMouseMove(e) {\n    const deltaX = e.pageX - this.state.originX;\n    const deltaY = e.pageY - this.state.originY;\n    const distance = Math.abs(deltaX) + Math.abs(deltaY);\n    if (!this.state.dragging && distance > DRAG_THRESHOLD) {\n      if (this.props.onDragStart) {\n        this.props.onDragStart(this.props.dragData);\n      }\n      this.state.dragging = true;\n    }\n    if(this.state.dragging) {\n      this.setState((prestate) => {\n        const pos = {};\n        const computedLeft = prestate.elementX + deltaX + document.body.scrollLeft;\n        const computedTop  = prestate.elementY + deltaY + document.body.scrollTop;\n        if (this.props.axis === 'none') {\n          pos.left = computedLeft;\n          pos.top = computedTop;\n        }\n        if (this.props.axis === 'x') {\n          pos.left = computedLeft;\n          pos.top =prestate.elementY;\n        }\n        if (this.props.axis === 'y') {\n          pos.left = prestate.elementX;\n          pos.top = computedTop;\n        }\n        return pos;\n      });\n    }\n  }\n\n  onMouseUp() {\n    this.removeEvent();\n    const { onDragStop } = this.props;\n    const { dragging } = this.state;\n    if (dragging) {\n      if (onDragStop) {\n        onDragStop();\n      }\n      this.setState({ dragging: false });\n    }\n  }\n\n  addEvent() {\n    document.onselectstart = () => false;\n    document.ondragstart = () => false;\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n  }\n\n  removeEvent() {\n    document.onselectstart = null;\n    document.ondragstart = null;\n    document.removeEventListener('mousemove', this.onMouseMove);\n    document.removeEventListener('mouseup', this.onMouseUp);\n  }\n\n  componentWillUnmount() {\n    this.setState = (state, callback) => {\n      return\n    }\n  }\n\n  style() {\n    const { dragging, left, top, width, height } = this.state;\n    if (dragging) {\n      return {\n        position: 'fixed',\n        opacity: .6,\n        left,\n        top,\n        width,\n        height,\n        zIndex: 12,\n      }\n    }\n    return {};\n  }\n\n  render() {\n    return (\n      <div\n        style={this.style()}\n        className={this.props.className}\n        onMouseDown={this.onMouseDown}>\n        {this.props.children}\n      </div>\n    );\n  }\n}","import React from 'react';\nimport classnames from 'classnames';\nimport PropTypes from 'prop-types';\n// import Draggable, {DraggableCore} from 'react-draggable';\nimport Draggable from './Draggable';\n\nexport default class Th extends React.Component {\n\n  static contextTypes = {\n    table: PropTypes.any,\n  };\n\n  state = {\n    style: {}\n  };\n\n  handleMouseDown = (e) => {\n    const { column, type } = this.props;\n    if (this.draggingColumn) {\n      this.dragging = true;\n      const { table } = this.context;\n      const { tableEl, colResizeProxy, rowResizeProxy } = table;\n      const tableRect = tableEl.getBoundingClientRect();\n      const { left:tableLeft, top:tableTop } = tableRect;\n      let thEl = e.target;\n      while (thEl && thEl.tagName !== 'TH') {\n        thEl = thEl.parentNode;\n      }\n      \n      \n      const thRect = thEl.getBoundingClientRect();\n      const minLeft = thRect.left - tableLeft + 30;\n      const minTop = thRect.top - tableTop + 30;\n\n      const startMouseLeft = e.clientX;\n      const startMouseTop = e.clientY;\n      const startLeft = thRect.right - tableLeft;\n      \n      if (this.direction === 'hori') {\n        colResizeProxy.style.visibility = 'visible';\n        colResizeProxy.style.left = startLeft + 'px';\n      }\n\n      const startTop =  thRect.bottom - tableTop;\n      if (this.direction === 'vert') {\n        rowResizeProxy.style.visibility = 'visible';\n        rowResizeProxy.style.top = startTop + 'px';\n      }\n \n      document.onselectstart = () => false;\n      document.ondragstart = () => false;\n\n      const handleMouseMove = (event) => {\n        const deltaLeft = event.clientX - startMouseLeft;\n        const proxyLeft = startLeft + deltaLeft;\n        colResizeProxy.style.left = Math.max(minLeft, proxyLeft) + 'px';\n\n        const deltaTop = event.clientY - startMouseTop;\n        const proxyTop = startTop + deltaTop;\n        rowResizeProxy.style.top = Math.max(minTop, proxyTop) + 'px';\n      };\n\n      const handleMouseUp = (event) => {\n        if (this.dragging) {\n          if (this.direction === 'hori') {\n            const offsetWidth = event.clientX - startMouseLeft;\n            let targetNode;\n            if (type === 'col') {\n              targetNode = this.headerTree.getLastNode(column);\n            }\n            if (type === 'row') {\n              const { level } = column;\n              const index = level - 1;\n              targetNode = this.headerTree.getDeepestNodeByIndex(index);\n            }\n            if (type === 'corner') {\n              const { rowHeaderTree } = this.context.table;\n              targetNode = rowHeaderTree.getDeepestNodeByIndex();\n            }\n            const calWidth = (targetNode.width || targetNode.realWidth || targetNode.minWidth) + offsetWidth;\n            targetNode.width = calWidth < 80 ? 80 : calWidth;\n            targetNode.realWidth = targetNode.width;\n          }\n\n          if (this.direction === 'vert') {\n            const offsetHeight = event.clientY - startMouseTop;\n            let targetNode;\n            if (type === 'col') {\n              const { level, rowSpan } = column;\n              const index = level + rowSpan - 2;\n              targetNode = this.headerTree.getDeepestNodeByIndex(index);\n            }\n            if (type === 'row') {\n              targetNode = this.headerTree.getLastNode(column);          \n            }\n            if (type === 'corner') {\n              const { colHeaderTree } = this.context.table;\n              targetNode = colHeaderTree.getDeepestNodeByIndex();\n            }\n            const calHeight = targetNode.height + offsetHeight;\n            targetNode.height = calHeight < 30 ? 30 : calHeight;\n          }\n\n          this.dragging = false;\n          this.draggingColumn = null;\n\n          document.body.style.cursor = '';\n          colResizeProxy.style.visibility = 'hidden';\n          rowResizeProxy.style.visibility = 'hidden';\n          document.removeEventListener('mousemove', handleMouseMove);\n          document.removeEventListener('mouseup', handleMouseUp);\n          document.onselectstart = null;\n          document.ondragstart = null;\n\n          this.context.table.onLayoutChange();\n\n          this.context.table.scheduleLayout();\n        }\n      }\n\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n    }\n  }\n\n\n  get headerTree() {\n    const { type } = this.props;\n    if (type === 'row') {\n      return this.context.table.rowHeaderTree;\n    }\n    if (type === 'col') {\n      return this.context.table.colHeaderTree;\n    }\n    return {};\n  }\n\n  dispatchEvent(name, ...args) {\n    const fn = this.props[name];\n    fn && fn(...args);\n  }\n\n  get disableResizeCol() {\n    const { resizeWidth } = this.context.table.props;\n    if (!resizeWidth) {\n      return true;\n    }\n    return false;\n  }\n\n  get disableResizeRow() {\n    const { resizeHeight } = this.context.table.props;\n    if (!resizeHeight) {\n      return true;\n    }\n    return false;\n  }\n\n  handleMouseMove = (e) => {\n    const { column } = this.props;\n    if (this.headerTree.sortingColumn) return;\n    if (!this.dragging) {\n      let target = e.target;\n      while (target && target.tagName !== 'TH') {\n        target = target.parentNode;\n      }\n\n      const rect = target.getBoundingClientRect();\n      const bodyStyle = document.body.style;\n\n      if (rect.width > 12 && rect.right - e.pageX < 5) {\n        if (this.disableResizeCol) return;\n        bodyStyle.cursor = 'col-resize';\n        this.draggingColumn = column;\n        this.direction = 'hori';\n      } else if ( rect.height > 12 && rect.bottom - e.clientY < 5) {\n        if (this.disableResizeRow) return;\n        bodyStyle.cursor = 'row-resize';\n        this.direction = 'vert';\n        this.draggingColumn = column;\n      } else {\n        bodyStyle.cursor = '';\n        this.draggingColumn = null;\n        this.direction = null;\n      }\n    }\n  }\n\n  handleMouseOut = () => {\n    document.body.style.cursor = '';\n  }\n\n  onMouseEnter = () => {\n    const { column, type } = this.props;\n    const { colHeaderTree, rowHeaderTree } = this.context.table;\n    if (type === 'col') {\n      if (colHeaderTree.sortingColumn) {\n        if (colHeaderTree.sortSameLevelPos(column)) {\n          this.context.table.refreshColumn();\n        };\n      }\n      colHeaderTree.sortingColumn = null;\n    } else {\n      if (rowHeaderTree.sortingColumn) {\n        if (rowHeaderTree.sortSameLevelPos(column)) {\n          this.context.table.refreshColumn();\n        };\n      }\n      rowHeaderTree.sortingColumn = null;\n    }\n      \n  }\n\n  handleSortStart = () => {\n    const { column, type } = this.props;\n    const { colHeaderTree, rowHeaderTree } = this.context.table; \n    if (type === 'col') {\n      colHeaderTree.sortingColumn = column;\n    } else {\n      rowHeaderTree.sortingColumn = column;\n    }\n  }\n\n  handleSortStop = () => {\n   setTimeout(() => {\n    const { colHeaderTree, rowHeaderTree } = this.context.table; \n    colHeaderTree.sortingColumn = null;\n    rowHeaderTree.sortingColumn = null;\n   }, 200);\n  }\n\n  getEextraProps() {\n\n  }\n\n  render() {\n    const { column, type } = this.props;\n    const { style } = this.state;\n    const { colSpan, rowSpan, name, children } = column;\n    const { sortSameLevelColumn } = this.context.table.props;\n    return (\n      <th\n        colSpan={colSpan}\n        rowSpan={rowSpan}\n        onMouseMove={this.handleMouseMove}\n        onMouseOut={this.handleMouseOut}\n        onMouseDown={this.handleMouseDown}\n        onMouseEnter={this.onMouseEnter}\n        className={classnames({leaf: !children})}\n        height={column.computedHeight()}\n        style={style}\n      >\n        {\n          sortSameLevelColumn\n            ? (\n                <Draggable\n                  handle=\".icon\"\n                  axis={type===\"col\" ? \"x\": \"y\"}\n                  onDragStart={this.handleSortStart}\n                  onDragStop={this.handleSortStop}\n                >\n                  <div className=\"cell exchange\">\n                    <div className={`icon ${type===\"col\" ? \"x\": \"y\"}`}>\n\n                    </div>\n                    {name}\n                  </div>\n                </Draggable>\n              )\n            : (\n              <div className=\"cell\">{name}</div>\n            )\n        }\n      </th>\n    );\n  }\n}","import React from 'react';\nimport { getAscId }  from './util';\nimport Th from './Th';\n\nexport default class TableRowHeader extends React.Component {\n\n  getColWidth(width) {\n    if (width > 100) {\n      return width;\n    }\n    return 100;\n  }\n\n  get gutterWidth() {\n    const { forceHideYGutter, scrollY, gutterWidth } = this.props.store;\n    if (forceHideYGutter || !scrollY) {\n      return 0;\n    }\n    return gutterWidth;\n  }\n\n  render() {\n    const { colHeaderWidth, store } = this.props;\n    const { columnHeader } = store;\n    return (\n      <table border=\"0\" cellPadding=\"0\" cellSpacing=\"0\" style={{borderBottom: 0, width: colHeaderWidth}}>\n        <colgroup>\n          {\n            store.columns.map(({realWidth, prop}) => (\n              <col width={realWidth} style={{ width: realWidth }} key={prop} />\n            ))\n          }\n        </colgroup>\n        <thead>\n          {\n            columnHeader.map( rs => (\n              <tr key={getAscId()}>\n                {\n                  rs.map((c) => (\n                      <Th type=\"col\" column={c} key={c.prop}/>\n                    )\n                  )\n                }\n                <th className=\"gutter-col\" style={{ width: this.gutterWidth}}></th>\n              </tr>\n            ))\n          }\n        </thead>\n      </table>\n    );\n  }\n}","import React from 'react';\nimport { getAscId }  from './util';\nimport Th from './Th';\n\nexport default class TableRowHeader extends React.Component {\n\n  render() {\n    const { store, tree } = this.props;\n    const { rowTableColGroup, rowHeader, rowHeaderWidth } = store;\n    return (\n      <table border=\"0\" cellSpacing=\"0\" style={{width: rowHeaderWidth}}>\n        <colgroup>\n          {\n            rowTableColGroup.map(({realWidth, key}) => (\n              <col width={realWidth} style={{ realWidth }} key={key} />\n            ))\n          }\n        </colgroup>\n        <thead>\n          {\n            rowHeader.map( rs => (\n              <tr key={getAscId()}>\n                {\n                  rs.map(c => <Th type=\"row\" column={c} key={getAscId()}/>)\n                }\n              </tr>\n            ))\n          }\n          {\n            store.scrollX && (\n              <tr>\n                <th className=\"gutter-row\" colSpan={tree.deepestNodePath.length} height=\"17\">\n\n                </th>\n              </tr>\n            )\n          }\n        </thead>\n      </table>\n    );\n  }\n}","import React from 'react';\nimport { getAscId }  from './util';\nimport { throttle } from 'throttle-debounce'; \n\nexport default class TableBody extends React.Component {\n\n  static defaultProps = {\n    rowsInView: 20,\n  }\n\n  state = {\n    recordsInView: [],\n    offsetIndex: 0,\n  };\n\n  constructor(props) {\n    super(props);\n    this.lazyRenderRows = throttle(500, this.lazyRenderRows);\n  }\n\n  getCellHeight(index) {\n    const { showRowHeader, store } = this.props;\n    const { rowGroup } = store;\n    if (showRowHeader && rowGroup && rowGroup.length) {\n      return rowGroup[index].computedHeight() - 1;\n    }\n    return 30;\n  }\n\n  get rows() {\n    const { rowGroup } = this.props.store;\n    return rowGroup.length;\n  }\n\n  getMapData() {\n    const { rowGroup, data, columns } = this.props.store;\n    if (this.props.isNoData) {\n      return <tr></tr>;\n    }\n    return rowGroup.map((row, rowIndex) => (\n      <tr key={getAscId()}>\n        {\n          columns.map(column => {\n            return (\n              <td key={getAscId()}>\n                <div className=\"cell\" style={{height: this.getCellHeight(rowIndex)}}>\n                  {data[row.prop] && data[row.prop][column.prop]}\n                </div>\n              </td>\n            );\n          })\n        }\n      </tr>\n    )\n      \n    );\n  }\n\n  getLazyData() {\n    const { store, isNoData } = this.props;\n    const { recordsInView } = this.state;\n    if (isNoData) {\n      return <tr></tr>;\n    }\n    return recordsInView.map((row, rowIndex) => {\n      return (\n        <tr key={getAscId()}>\n          {\n            store.columns.map(column => {\n              return (\n                <td key={getAscId()}>\n                  <div className=\"cell\" style={{height: this.getCellHeight(rowIndex)}}>\n                    {row && row[column.prop]}\n                  </div>\n                </td>\n              );\n            })\n          }\n        </tr>\n      );\n    });\n  }\n\n  lazyRenderRows(offsetIndex = 0) {\n    const { rowGroup, data } = this.props.store;\n    if (rowGroup.length) {\n      const recordsInView = [];\n      for(let i = 0; i < this.props.rowsInView; i++) {\n        const rowHeaderItem = rowGroup[offsetIndex + i];\n        if (rowHeaderItem) {\n          const rowProp = rowHeaderItem.prop;\n          const row = data[rowProp];\n          recordsInView.push(row);\n        }\n      }\n      this.setState({recordsInView, offsetIndex});\n    }\n  }\n\n  render() {\n    const { colHeaderWidth, store, lazyLoading, isNoData } = this.props;\n    const { offsetIndex } = this.state;\n    return lazyLoading\n            ? <div style={{height: isNoData ? 0 : this.rows * 30}}>\n                <table border=\"0\" cellSpacing=\"0\" style={{width: colHeaderWidth - (store.scrollY ? store.gutterWidth : 0), transform: `translate(0, ${offsetIndex * 30}px)`}} className=\"dc-table-real-body\">\n                  <colgroup>\n                    {\n                      store.columns.map((column, index) => (\n                        <col width={column.realWidth} style={{ width: column.realWidth }} key={column.prop} />\n                      ))\n                    }\n                  </colgroup>\n                  <tbody>\n                    {this.getLazyData()}\n                  </tbody>\n                </table>\n              </div>\n            : <table border=\"0\" cellSpacing=\"0\" style={{width: colHeaderWidth - (store.scrollY ? store.gutterWidth : 0)}} className=\"dc-table-real-body\">\n                <colgroup>\n                  {\n                    store.columns.map((column, index) => (\n                      <col width={column.realWidth} style={{ width: column.realWidth }} key={column.prop} />\n                    ))\n                  }\n                </colgroup>\n                  <tbody>\n                    {this.getMapData()}\n                  </tbody>\n              </table>\n      }\n  \n}","import { getAscId } from \"./util\";\n\nexport default class Node {\n  parent = null;\n  children = [];\n  data = null;\n  key = null;\n  level = null;\n  colSpan = 0;\n  rowSpan = 0;\n  width = null;\n  height = 0;\n  minHeight = 30;\n  minWidth = 80;\n  realWidth = 80;\n  prop = null;\n  field = null;\n  name = '';\n\n  constructor({children, name, prop, field, width, height = 40} = {}) {\n    this.name = name;\n    this.prop = prop || field;\n    this.width = width;\n    this.realWidth = width;\n    this.height = height;\n    this.key = getAscId();\n  }\n\n  addChild(data) {\n    this.children.push(data);\n  }\n\n  computedHeight() {\n    return this.height || this.minHeight;\n  }\n\n  // for stringify\n  clear() {\n    // keep prop, children\n    this.parent = undefined;\n    this.data = undefined;\n    this.key = undefined;\n    this.colSpan = undefined;\n    this.rowSpan = undefined;\n    this.width = undefined;\n    this.height = undefined;\n    this.minHeight = undefined;\n    this.minWidth = undefined;\n    this.realWidth = undefined;\n    this.field = undefined;\n    this.name = undefined;\n    this.start = undefined;\n  }\n}","import Node from './node';\nimport cloneDeep from 'lodash.clonedeep';\n// import differenceby from 'lodash.differenceby';\nimport remove from 'lodash.remove';\n\nexport default class Tree {\n  children = [];\n  deepestNodePath = [];\n  leafNodes = [];\n  setting = {};\n  sorting = [];\n  root = new Node();\n\n  sortingColumn = null;\n\n  constructor(data = [], setting = {}, sorting = []) {\n    this.setting = setting;\n    this.sorting = sorting;\n    this.buildTree(data);\n  }\n\n  buildTree(data) {\n    this._initTree(data);\n    this.deepestNodePath = this._findDeepestNodePath();\n    this.leafNodes = this.getLeafNodes();\n  }\n\n  _traverse(node, parent) {\n    const { prop, field } = node;\n    const savedConfig = this.setting[prop] || this.setting[field];\n    if (savedConfig) {\n      Object.assign(node, savedConfig);\n    }\n    const currentNode = new Node(node);\n    if (parent) {\n      currentNode.parent = parent;\n      parent.addChild(currentNode);\n    }\n    \n    if (node.children) {\n      node.children.forEach(item => {\n        this._traverse(item, currentNode);\n      })\n    }\n  }\n\n  _initTree(data) {\n    // saved col setting\n    const start = new Date().getTime();\n    if (this.sorting) {\n      const mockCloneData = { children: cloneDeep(data), prop: 'root' };\n      const mockData = { children: data, prop: 'root' };\n      const mockSorted = { children: this.sorting, prop: 'root' };\n      this.traverseDF(node => {\n        const prop = node.prop;\n        const dataNode = this.getNodeByProp(prop, mockData);\n        const sortedNode = this.getNodeByProp(prop, mockSorted);\n        if (sortedNode) {\n          this.soredNodesWidthSeq(dataNode.children, sortedNode.children);\n        }\n        \n      }, mockCloneData);\n    }\n    const end = new Date().getTime();\n    console.log('used time: ', end - start);\n    data.forEach(item => {\n      this._traverse(item, this.root);\n    });\n  }\n\n  // source 原地算法排序\n  soredNodesWidthSeq(source, dest) {\n    dest.forEach((item) => {\n      const tempEl = remove(source, function(i) {\n        return i.prop === item.prop;\n      });\n      if (tempEl.length) {\n        source.push(tempEl[0]);\n      }\n    });\n  }\n  \n  _findDeepestNodePath() {\n    const allNodes = this.getBFSNodes();\n    // deepest node\n    let dn = allNodes[allNodes.length-1];\n    const deepestPath = [];\n    while(dn && dn.parent) {\n      deepestPath.unshift(dn);\n      dn = dn.parent;\n    }\n\n    return deepestPath;\n  }\n\n  // BFS\n  getBFSNodes() {\n    const allNodes = [];\n    const queue = this.root.children.slice();\n\n    for (let i = 0; queue[i]; i++) {\n      allNodes.push(queue[i]);\n      if (queue[i].children) queue.push(...queue[i].children);\n    }\n\n    return allNodes;\n  }\n\n  getNodeByProp(prop, root) {\n    let node = null;\n    this.traverseDF((n)=> {\n      if(n.prop === prop) {\n        node = n;\n        return true;\n      }\n    }, root);\n    return node;\n  }\n\n  getDFSNodes() {\n    const rootNode = cloneDeep(this.root);\n    this.traverseDF((node) => {\n      node.clear();\n    }, rootNode);\n    return rootNode.children;\n  }\n\n  traverseDF(cb, parent) {\n    let pNode = parent || this.root\n    if (!pNode) return;\n    const recurse = (node) => {\n      if(cb(node)) return;\n      if (node.children) {\n        for(let i = 0; i < node.children.length; i++) {\n          recurse(node.children[i]);\n        }\n      }\n    }\n    recurse(pNode);\n  }\n\n  getLeafNodes(nodes = this.root.children) {\n    const result = [];\n    nodes.forEach((node) => {\n      if (node.children && node.children.length) {\n        result.push(...this.getLeafNodes(node.children));\n      } else {\n        result.push(node);\n      }\n    });\n    return result;\n  }\n\n  getLastNode(node = this.root, cb) {\n    let tn = node;\n    while(tn && tn.children.length) {\n      const l = tn.children.length;\n      tn = tn.children[l-1];\n      cb && cb(tn);\n    }\n    return tn;\n  }\n\n  getDeepestNodeByIndex(index = this.deepestNodePath.length - 1) {\n    return this.deepestNodePath[index];\n  }\n\n  sortSameLevelPos(rep) {\n    if (this.sortingColumn && (this.sortingColumn.level !== rep.level)) {\n      return false;\n    }\n\n    const parent = this.sortingColumn.parent;\n    const repParent = rep.parent;\n    if (parent !== repParent) {\n      return false;\n    }\n\n    const sortingIndex = parent.children.indexOf(this.sortingColumn);\n    const rIndex = parent.children.indexOf(rep);\n    parent.children.splice(sortingIndex, 1);\n    parent.children.splice(rIndex, 0, this.sortingColumn);\n\n    this.leafNodes = this.getLeafNodes();\n\n    return true;\n  }\n\n  // 递归对比每个子节点数据是否一致\n  // isSavedTreeVaild(data, sorting) {\n  //   if (!data.length || !sorting.length) return false;\n  //   if (data.length !== sorting.length) return false;\n  //   const mockData = { children: data, prop: 'root' };\n  //   const mockSorting = { children: sorting, prop: 'root' };\n\n  //   let validTree = true;\n  //   this.traverseDF((node) => {\n  //     const prop = node.prop;\n  //     const sortedNode = this.getNodeByProp(prop, mockSorting);\n  //     // 保存树找不到对象返回 true 结速递归，并标记此保存数据无效。\n  //     if (!sortedNode) {\n  //       validTree = false;\n  //       return true;\n  //     }\n  //     const diff = differenceby(node.children, sortedNode.children, \"prop\");\n\n  //     // 保存树对比数据不一致返回 true 结速递归，并标记此保存数据无效。\n  //     if (diff.length) {\n  //       validTree = false;\n  //       return true;\n  //     }\n  //   }, mockData);\n\n  //   return validTree;\n  // }\n\n}","import React from 'react';\nimport PropTypes from 'prop-types';\nimport TableColumnHeader from './TableColumnHeader';\nimport TableRowHeader from './TableRowHeader';\nimport TableBody from './TableBody';\nimport { convertToColumnHeader, convertToRowHeader, getScrollBarWidth } from './util';\nimport Tree from './tree';\nimport Node from './node';\nimport Th from './Th';\n\nimport './style.css';\nimport { isNumber } from 'util';\n\nexport default class Table extends React.Component {\n\n  static defaultProps = {\n    border: 1,\n    width: 100,\n    setting: {},\n    resizeWidth: true,\n    resizeHeight: true,\n    showColumnHeader: true,\n    showRowHeader: true,\n    sortSameLevelColumn: false,\n    useMapData: false,\n    data: [],\n    columnHeader: [],\n    rowHeader: [],\n    className: '',\n  }\n\n  state = {\n    columns: [],\n    rowGroup: [],\n    rowTableColGroup: [],\n    data: [],\n    layout: {},\n    rowHeaderWidth: 0,\n    colHeaderHeight: 0,\n    bodyWrapperHeight: 0,\n    columnHeader: [],\n    rowHeader: [],\n    gutterWidth: getScrollBarWidth(), // scrollBar width\n    scrollX: null, // has x scroll bar\n    scrollY: null, // has y scroll bar\n    forceHideYGutter: false,\n    lazyLoading: false,\n  }\n\n  static childContextTypes = {\n    table: PropTypes.any,\n  };\n\n  getChildContext() {\n    return {\n      table: this,\n    }\n  }\n\n  constructor(props) {\n    super(props);\n    const { columnHeader, rowHeader, setting } = props;\n    const { r, c, co } = setting || {};\n    this.colHeaderTree = new Tree(columnHeader, c, co);\n    this.rowHeaderTree = new Tree(rowHeader, r);\n    this.cornerNode = new Node({name: ''});\n  }\n\n  bindRef(key) {\n    return (node) => { this[key] = node; }\n  }\n\n  handleScroll = () => {\n    const { bodyWrapper, colHeaderWrapper, rowHeaderWrapper, showRowHeader, tableBody } = this;\n    if (this.showColumnHeader) {\n      colHeaderWrapper.scrollLeft = bodyWrapper.scrollLeft;\n    }\n    if (showRowHeader) {\n      rowHeaderWrapper.scrollTop = bodyWrapper.scrollTop;\n    }\n    if (this.state.lazyLoading) {\n      tableBody.lazyRenderRows(this.lazyStartIndex);\n    }\n  }\n\n  get lazyStartIndex() {\n    return Math.floor(this.bodyWrapper.scrollTop / 30);\n  }\n\n  scheduleLayout() {\n    this.calculateWidth();\n    this.forceUpdate(() => {\n      this.calculateHeight();\n      this.updateScrollY();\n      if (this.state.lazyLoading) {\n        this.tableBody.lazyRenderRows(this.lazyStartIndex);\n      }\n    });\n  }\n\n  componentWillUpdate() {\n    console.log('will update table');\n  }\n\n  calculateWidth() {\n    const { columns, rowTableColGroup, gutterWidth } = this.state;\n\n    const bodyMinWidth = columns.reduce((acc, col) => acc + (col.width || col.minWidth), 0);\n    const tableElWidth = this.tableEl.clientWidth;\n\n    if (this.showRowHeader) {\n      const rowHeaderWidth = rowTableColGroup.reduce((acc, col) => acc + (col.width || col.minWidth), 0);\n      this.state.rowHeaderWidth = rowHeaderWidth;\n    } else {\n      this.state.rowHeaderWidth = 0;\n    }\n\n    const flexColumns = columns.filter(col => typeof col.width !== 'number');\n    let bodyWidth = tableElWidth - this.state.rowHeaderWidth;\n\n    let scrollX;\n\n    if (flexColumns.length) {\n      if (bodyMinWidth < bodyWidth - gutterWidth) {\n        scrollX = false;\n        const totalFlexWidth = bodyWidth - gutterWidth - bodyMinWidth;\n        if (totalFlexWidth > 0) {\n          if (flexColumns.length === 1) {\n            flexColumns[0].realWidth = flexColumns[0].minWidth + totalFlexWidth;\n          } else {\n            const allColumnsWidth = flexColumns.reduce((pre, col) => pre + col.minWidth, 0);\n            const flexWidthPerPixel = totalFlexWidth / allColumnsWidth;\n\n            let widthWithoutFirst = 0;\n\n            flexColumns.forEach((column, index) => {\n              if (index === 0) return;\n              const flexWidth = Math.floor(column.minWidth * flexWidthPerPixel);\n              widthWithoutFirst += flexWidth;\n              column.realWidth = column.minWidth + flexWidth;\n            });\n\n            flexColumns[0].realWidth = flexColumns[0].minWidth + totalFlexWidth - widthWithoutFirst;\n\n          }\n        }\n      } else {\n        scrollX = true;\n        flexColumns.forEach((column) => {\n          column.realWidth = column.minWidth;\n        });\n      } \n    } else {\n      scrollX = bodyMinWidth > bodyWidth;\n      columns.forEach(col => col.realWidth = col.width || col.minWidth )\n      bodyWidth = bodyMinWidth;\n    }\n    this.state.colHeaderWidth = Math.max(bodyMinWidth, bodyWidth);\n    this.state.scrollX = scrollX;\n    \n    this.state.forceHideYGutter = this.state.colHeaderWidth < tableElWidth - this.state.rowHeaderWidth;\n  }\n\n  calculateHeight() {\n    this.setState(state => {\n      const { colHeaderWrapper } = this;\n      let colHeaderHeight;\n      if (this.props.showColumnHeader) {\n        colHeaderHeight = colHeaderWrapper.clientHeight;\n      } else {\n        colHeaderHeight = 0;\n      }     \n      const { height, maxHeight } = this.props;\n      let bodyWrapperHeight = '100%';\n\n      if (height && isNumber(height)) {\n        bodyWrapperHeight = this.props.height - colHeaderHeight;\n      }\n\n      if (maxHeight && isNumber(maxHeight)) {\n        bodyWrapperHeight = this.props.maxHeight - colHeaderHeight;\n      }\n\n      this.cornerNode.height = colHeaderHeight;\n       \n      return {\n        colHeaderHeight,\n        bodyWrapperHeight\n      }\n      \n    });\n  }\n\n  updateScrollY() {\n    this.setState((state) => {\n      const { bodyWrapper } = this;\n     \n      const body = bodyWrapper.querySelector('.dc-table-real-body');\n      const scrollY = body.clientHeight > state.bodyWrapperHeight;\n\n      return {\n        scrollY\n      };\n    });\n  }\n\n  get tableWidth() {\n    const { width } = this.props;\n    if (width > 200) {\n      return width\n    }\n    return '100%';\n  }\n\n  get tableHeight() {\n    const { height, maxHeight } = this.props;\n    const style = {};\n\n    if (height) {\n      style.height = height || '';\n    } else if (maxHeight) {\n      style.maxHeight = maxHeight;\n    }\n\n    return style;\n  }\n\n  get bodyHeightOrMaxHeight() {\n    const { height, maxHeight } = this.props;\n    const { bodyWrapperHeight } = this.state;\n    const style = {};\n    if (height) {\n      style.height = bodyWrapperHeight || '';\n    } else if (maxHeight) {\n      style.maxHeight = bodyWrapperHeight;\n    }\n    return style;\n  }\n\n  get showCorner() {\n    const { showColumnHeader, showRowHeader } = this.props;\n    const { columns, rowGroup } = this.state;\n    return (\n      showColumnHeader &&\n      showRowHeader &&\n      Boolean(columns.length) &&\n      Boolean(rowGroup.length)\n    );\n  }\n\n  get showRowHeader() {\n    const { showRowHeader } = this.props;\n    const { rowGroup } = this.state;\n    return (\n      showRowHeader &&\n      Boolean(rowGroup.length)\n    );\n  }\n\n  get showColumnHeader() {\n    return this.props.showColumnHeader;\n  }\n \n  getConfig() {\n    const { rowHeaderTree, colHeaderTree, props, tableWidth } = this;\n    const { height } = props;\n    const colConfig = {},\n          rowConfig = {};\n\n    colHeaderTree.deepestNodePath.forEach(({prop, height}) => {\n      let cell = colConfig[prop];\n      if (!cell) {\n        cell = {};\n      }\n      cell.height = height;\n      colConfig[prop] = cell;\n    });\n\n    colHeaderTree.leafNodes.forEach(({prop, width}) => {\n      let cell = colConfig[prop];\n      if (!cell) {\n        cell = {};\n      }\n      cell.width = width;\n      colConfig[prop] = cell;\n    });\n\n    rowHeaderTree.deepestNodePath.forEach(({prop, width}) => {\n      let cell = rowConfig[prop];\n      if (!cell) {\n        cell = {};\n      }\n      cell.width = width;\n      rowConfig[prop] = cell;\n    });\n\n    rowHeaderTree.leafNodes.forEach(({prop, height}) => {\n      let cell = rowConfig[prop];\n      if (!cell) {\n        cell = {};\n      }\n      cell.height = height;\n      rowConfig[prop] = cell;\n    });\n\n    return {\n      w: tableWidth,\n      h: height,\n      c: colConfig,\n      // column order\n      co: colHeaderTree.getDFSNodes(),\n      ro: rowHeaderTree.getDFSNodes(),\n      r: rowConfig,\n    };\n  }\n\n  safeCallLayoutChange() {\n    this.props.onLayoutChange && this.props.onLayoutChange(this.getConfig());\n  }\n\n  onLayoutChange() {\n    this.scheduleLayout();\n    this.safeCallLayoutChange();\n  }\n\n  refreshColumn() {\n    const columns = this.colHeaderTree.leafNodes;\n    const rowGroup = this.rowHeaderTree.leafNodes;\n    const columnHeader = convertToColumnHeader(this.colHeaderTree.root.children);\n    const rowHeader = convertToRowHeader(this.rowHeaderTree.root.children);\n    this.setState({ columns, rowGroup, columnHeader, rowHeader }, () => {\n      this.safeCallLayoutChange();\n      if (this.state.lazyLoading) {\n        this.tableBody.lazyRenderRows(this.lazyStartIndex);\n      }\n    });\n  }\n\n  refreshTable(data) {\n    const columns = this.colHeaderTree.leafNodes;\n    const rowGroup = this.rowHeaderTree.leafNodes;\n    const rowTableColGroup = this.rowHeaderTree.deepestNodePath;\n    const columnHeader = convertToColumnHeader(this.colHeaderTree.root.children);\n    const rowHeader = convertToRowHeader(this.rowHeaderTree.root.children);\n\n    // if cell > 300  force use lazy loading.\n    let lazyLoading = false;\n    if (rowGroup.length * columns.length > 3000) {\n      lazyLoading = true;\n    }\n    this.setState({\n      columns,\n      rowGroup,\n      rowTableColGroup,\n      columnHeader,\n      rowHeader,\n      data,\n      lazyLoading,\n    }, this.scheduleLayout);\n  }\n\n  componentDidMount() {\n    const { data } = this.props;\n    this.refreshTable(data);\n  }\n\n  componentWillReceiveProps({columnHeader, rowHeader, data, setting}) {\n    if (this.props.columnHeader === columnHeader && this.props.rowHeader === rowHeader && this.props.data === data) {\n      return;\n    } else {\n      const { r, c, co, ro } = setting || {};\n      this.colHeaderTree = new Tree(columnHeader, c, co);\n      this.rowHeaderTree = new Tree(rowHeader, r, ro);\n      this.refreshTable(data);\n    }\n  }\n\n  get isNoData() {\n    const { data } = this.state;\n    if (Array.isArray(data) && data.length) {\n      return false;\n    }\n    if (Object.keys(data).length) {\n      return false;\n    }\n    return true;\n  }\n\n  render() {\n    const {\n      rowHeaderWidth,\n      colHeaderWidth,\n      colHeaderHeight,\n    } = this.state;\n    const { className } = this.props;\n    \n    return (\n      <div\n        ref={this.bindRef('tableEl')}\n        className={`dc-table ${className}`}\n        style={\n          Object.assign({\n              width: this.tableWidth,\n              overflow: 'hidden'\n            },\n            this.tableHeight\n          )\n        }\n      >\n        <div\n          style={{\n            marginLeft: rowHeaderWidth\n          }}\n          ref={this.bindRef('colBodyWrapper')}\n        >\n          {\n            this.showColumnHeader && (\n              <div ref={this.bindRef('colHeaderWrapper')} className=\"col-header-wrapper\">\n                <TableColumnHeader\n                  {...this.props}\n                  store={this.state}\n                  colHeaderWidth={colHeaderWidth}\n                />\n              </div>\n            )\n          }\n          <div ref={this.bindRef('bodyWrapper')} style={this.bodyHeightOrMaxHeight} className=\"body-wrapper\" onScroll={this.handleScroll}>\n            <TableBody\n              ref={this.bindRef('tableBody')}\n              {...this.props}\n              lazyLoading={this.state.lazyLoading}\n              store={this.state}\n              colHeaderWidth={colHeaderWidth}\n              rowsInView={Math.ceil(this.props.maxHeight / 30)}\n              isNoData={this.isNoData}\n            />\n            {\n              this.isNoData && (\n                <div\n                  style={this.bodyHeightOrMaxHeight}\n                  className=\"nodata-block\"\n                >\n                  <div className=\"nodata-text\">No Data</div>\n                </div>\n              )\n            }\n          </div>\n        </div>\n        {\n          this.showRowHeader && (\n            <div\n              className=\"row-header-wrapper\"\n              ref={this.bindRef('rowHeaderWrapper')}\n              style={{\n                marginTop: colHeaderHeight,\n                ...this.bodyHeightOrMaxHeight\n              }}\n            >\n              <TableRowHeader\n                {...this.props}\n                store={this.state}\n                tree={this.rowHeaderTree}\n              />\n            </div>\n          )\n        }\n        \n        {\n          this.showCorner && (\n            <div\n              className=\"corner-block\"\n              style={{\n                width: rowHeaderWidth,\n                height: colHeaderHeight\n              }}\n            >\n              <table border=\"0\" cellSpacing=\"0\" width=\"100%\">\n                <thead>\n                  <tr>\n                    <Th type=\"corner\" column={this.cornerNode}/>\n                  </tr>\n                </thead>\n              </table>\n            </div>\n          )\n        }\n        \n        <div\n          className=\"dc-table-col-resize-proxy\"\n          ref={this.bindRef('colResizeProxy')}\n          style={{ visibility: 'hidden' }}\n        />\n        <div\n          className=\"dc-table-row-resize-proxy\"\n          ref={this.bindRef('rowResizeProxy')}\n          style={{ visibility: 'hidden' }}\n        />\n      </div>\n    );\n  }\n}","import Table from './Table';\n\nexport default Table;\n","export default {\n  rowHeader:[{\n    name: \"服装\",\n    prop: 'a',\n    children: [{\n      name: \"上衣\",\n      prop: '0',\n      children: [],\n    }, {\n      name: \"帽子\",\n      prop: '1',\n      children: [],\n    }, {\n      name: \"裤子\",\n      prop: '2',\n      children: [],\n    }, {\n      prop: '3',\n      name: \"鞋子\",\n      children: [],\n    }],\n  }, {\n    name: \"电器\",\n    prop: 'b',\n    children: [{\n      prop: '4',\n      name: \"冰箱\",\n      children: [],\n    }, {\n      prop: '5',\n      name: \"电视\",\n      children: [],\n    }, {\n      prop: '6',\n      name: \"空调\",\n      children: [],\n    }, {\n      name: \"风扇\",\n      prop: '7',\n      children: [],\n    }],\n  }],\n  columnHeader:[{\n    name: \"2,018\",\n    prop: \"2018\",\n    children: [{\n      name: \"Q1\",\n      prop: \"2018-Q1\",\n      children: [],\n    }, {\n      name: \"Q2\",\n      prop: \"2018-Q2\",\n      children: [],\n    }, {\n      name: \"Q3\",\n      prop: \"2018-Q3\",\n      children: [],\n    }, {\n      name: \"Q4\",\n      prop: \"2018-Q4\",\n      children: [],\n    }],\n  }, {\n    name: \"2,019\",\n    prop: \"2019\",\n    children: [{\n      name: \"Q1\",\n      prop: \"2019-Q1\",\n      children: [],\n    }, {\n      name: \"Q2\",\n      prop: \"2019-Q2\",\n      children: [],\n    }, {\n      name: \"Q3\",\n      prop: \"2019-Q3\",\n      children: [],\n    }, {\n      name: \"Q4\",\n      prop: \"2019-Q4\",\n      children: [],\n    }],\n  }],\n  data: {\n    0: {\n      \"2018-Q1\": 1,\n      \"2018-Q2\": 2,\n      \"2018-Q3\": 3,\n      \"2018-Q4\": 4,\n      \"2019-Q1\": 5,\n      \"2019-Q2\": 6,\n      \"2019-Q3\": 7,\n      \"2019-Q4\": 8,\n    },\n    1: {\n      \"2018-Q1\": 2,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    2: {\n      \"2018-Q1\": 3,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    3: {\n      \"2018-Q1\": 4,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    4: {\n      \"2018-Q1\": 5,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    5: {\n      \"2018-Q1\": 6,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    6: {\n      \"2018-Q1\": 7,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    7: {\n      \"2018-Q1\": 8,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    }\n  }\n};","import React, {useContext} from 'react';\nimport {CSTableContext} from './index';\n\nexport default function() {\n\n  const {\n    renderCell,\n    cellWidth = 120,\n    cellHeight = 40,\n    dataAreaState,\n  } = useContext(CSTableContext);\n\n  const {\n    processedHeader: header,\n    processedData: data,\n    rowStartIndex,\n  } = dataAreaState;\n\n  return ( \n    data.map((_, rowIndex) => (\n      header.map((h, colIndex) => (\n        <div\n          className=\"cell\"\n          key={`d-a-${rowIndex}-${colIndex}`}\n          style={{\n            position: 'absolute',\n            top: (rowIndex + rowStartIndex) * cellHeight,\n            left: h.left,\n            width: h.width || cellWidth,\n            height: cellHeight\n          }}\n        >\n          { \n            h.renderCell\n              ? h.renderCell(data[rowIndex][h.prop], (rowIndex + rowStartIndex), h.prop, h)\n              : renderCell(data[rowIndex][h.prop], (rowIndex + rowStartIndex), h.prop, h)\n          }\n        </div>\n      ))\n    ))\n  );\n}","import { useCallback, useRef } from \"react\";\n\nconst returnFalse = () => false;\n\nexport default function useResize ({\n  container,\n  colResizeProxy,\n  onResizeStop,\n}) {\n\n  const isDraggingRef = useRef(false);\n  const draggingCol = useRef();\n  const startPosRef = useRef();\n\n  const handleResizeStart = useCallback((e) => {\n    const movedDistance = e.clientX - container.current.getBoundingClientRect().left;\n    colResizeProxy.current.style.left = movedDistance + 'px';\n    document.body.style.cursor = 'col-resize';\n  }, [colResizeProxy, container.current]);\n\n  const handleResizeStop = useCallback((e) => {\n    colResizeProxy.current.style.visibility = 'hidden';\n    document.body.style.cursor = '';\n    document.removeEventListener('mousemove', handleResizeStart);\n    document.removeEventListener('mouseup', handleResizeStop);\n    isDraggingRef.current = false;\n    document.onselectstart = null;\n    document.ondragstart = null;\n    const offset = e.clientX - startPosRef.current;\n    \n    onResizeStop && onResizeStop(offset, draggingCol.current);\n    \n  }, [colResizeProxy, handleResizeStart, onResizeStop]);\n\n  const handleMouseMove = useCallback((e) => {\n    if (isDraggingRef.current) return;\n    const currHeader = e.currentTarget;\n    const rect = currHeader.getBoundingClientRect();\n    const bodyStyle = document.body.style;\n\n    if (rect.right - e.pageX < 5) {\n      bodyStyle.cursor = 'col-resize';\n      draggingCol.current = currHeader.dataset.prop;\n    } else {\n      bodyStyle.cursor = '';\n      draggingCol.current = null;\n    }\n  }, []);\n\n  const handleMouseOut = useCallback(() => {\n    document.body.style.cursor = '';\n  }, []);\n\n  const handleMouseDown = useCallback((e) => {\n    if (draggingCol.current) {\n      isDraggingRef.current = true;\n      const currTarget = e.currentTarget;\n      const containLeft = container.current.getBoundingClientRect().left;\n      const startPos = currTarget.getBoundingClientRect().right - containLeft;\n      colResizeProxy.current.style.visibility = 'visible';\n      colResizeProxy.current.style.left = startPos + 'px';\n      startPosRef.current = currTarget.getBoundingClientRect().right;\n\n      document.onselectstart = returnFalse;\n      document.ondragstart = returnFalse;\n\n      document.addEventListener('mousemove', handleResizeStart);\n      document.addEventListener('mouseup', handleResizeStop);\n    }\n  }, [colResizeProxy, handleResizeStart, handleResizeStop, container]);\n\n  return {\n    handleMouseMove,\n    handleMouseOut,\n    handleMouseDown,\n  };\n\n}","let scrollBarWidth;\nexport function getScrollBarWidth() {\n  if (scrollBarWidth !== undefined) return scrollBarWidth;\n  const dom = document.createElement('div');\n  const body = document.body || dom;\n\n  dom.style.visibility = 'hidden';\n  dom.style.width = '100px';\n  dom.style.position = 'absolute';\n  dom.style.top = '-9999px';\n  dom.style.overflow = 'scroll';\n\n  body.appendChild(dom);\n\n  const totalWidth = dom.offsetWidth;\n  const widthWithoutScroll = dom.clientWidth;\n\n  body.removeChild(dom);\n\n  return totalWidth - widthWithoutScroll;\n}\n\nexport function processHeaderWidth (header, defaultCellWidth, returnTotalWidth = false)  {\n  const totalWidth = header.reduce((acc, curr) => {\n    curr.left = acc;\n    const accWidth = (curr.width || defaultCellWidth) + acc\n    return accWidth;\n  }, 0);\n  if (returnTotalWidth) {\n    return totalWidth;\n  }\n  return header;\n}\n\nexport function getMutableIndexAndCount(header, scrollWidth, dataAreaWidth, defaultCellWidth) {\n  let accWidth = 0,\n      startIndex = 0,\n      endIndex = header.length - 1;\n  const totalWidth = scrollWidth + dataAreaWidth\n  for(let i = 0; i < header.length; i++) {\n    accWidth += (header[i].width) || defaultCellWidth;\n    if (accWidth < scrollWidth) {\n      startIndex = i;\n    }\n    if (accWidth > totalWidth) {\n      endIndex = i;\n      break;\n    }\n  }\n  return {\n    startIndex,\n    count: (endIndex - startIndex) + 1\n  };\n}\n","import React, { useContext, useCallback, useMemo } from 'react';\nimport { CSTableContext } from './index';\nimport useResize from '../hooks/useResize';\nimport { processHeaderWidth } from './util';\n\nexport default function() {\n\n  const {\n    cellWidth,\n    cellHeight,\n    renderHeader,\n    dataAreaState,\n    setDataAreaState,\n    tableRef,\n    colResizeProxyRef,\n    header: allHeader,\n    enableResize,\n  } = useContext(CSTableContext);\n\n  const {\n    processedHeader: header,\n  } = dataAreaState;\n\n  const onResizeStop = useCallback((offset, draggingProp) => {\n    const currH = header.find(h => h.prop === draggingProp);\n    if (currH) {\n      // min 30\n      currH.width = Math.max((currH.width || cellWidth) + offset, 30);\n      const dataAreaWidth = processHeaderWidth(allHeader, cellWidth, true);\n      // force update\n      setDataAreaState((prev) => ({...prev, dataAreaWidth}));\n    }\n  }, [header, setDataAreaState]);\n\n  const {\n    handleMouseMove,\n    handleMouseOut,\n    handleMouseDown,\n  } = useResize({\n    container: tableRef,\n    colResizeProxy: colResizeProxyRef,\n    onResizeStop,\n  });\n\n  const resizeProps = useMemo(() => (\n    enableResize\n      ? {\n          onMouseMove: handleMouseMove,\n          onMouseOut: handleMouseOut,\n          onMouseDown: handleMouseDown,\n        }\n      : {}\n    ),\n    [enableResize, handleMouseMove, handleMouseOut, handleMouseDown]\n  );\n  \n  return (\n    header.map((h, i) => (\n      <div\n        key={`h-${i}`}\n        className=\"header\"\n        style={{\n          position: 'absolute',\n          width: h.width || cellWidth,\n          height: cellHeight,\n          left: h.left,\n        }}\n        data-prop={h.prop}\n        {...resizeProps}\n      >\n        { \n          h.renderHeader\n            ? h.renderHeader(h, h.prop)\n            : renderHeader(h, h.prop)\n        }\n      </div>\n    ))\n  );\n}\n","import React, {useContext} from 'react';\nimport { CSTableContext } from './index';\n\nexport default function()  {\n\n  const {\n    cellWidth,\n    cellHeight,\n    dataAreaState,\n    renderCell,\n  } = useContext(CSTableContext);\n\n  const {\n    processedData: data,\n    rowStartIndex,\n    fixedLeftCol,\n  } = dataAreaState;\n  return (\n    data.map((_, rowIndex) => (\n      fixedLeftCol.map((h, colIndex) => (\n        <div\n          className=\"cell fixed-left\"\n          key={`f-c-${rowIndex}-${colIndex}`}\n          style={{\n            position: 'absolute',\n            top: (rowIndex + rowStartIndex) * cellHeight,\n            left: h.left,\n            width: h.width || cellWidth,\n            height: cellHeight\n          }}\n        >\n          { \n            h.renderCell\n              ? h.renderCell(data[rowIndex][h.prop], (rowIndex + rowStartIndex), h.prop, h)\n              : renderCell(data[rowIndex][h.prop], (rowIndex + rowStartIndex), h.prop, h)\n          }\n        </div>\n      ))\n    ))\n  );\n}\n","import React, {useContext} from 'react';\nimport { CSTableContext } from './index';\n\nexport default function()  {\n\n  const {\n    cellWidth,\n    cellHeight,\n    dataAreaState,\n    renderHeader\n  } = useContext(CSTableContext);\n\n\n  const {\n    fixedLeftCol,\n  } = dataAreaState;\n\n  return (\n    fixedLeftCol.map((h, colIndex) => (\n      <div\n        key={`f-h-${colIndex}`}\n        className=\"header\"\n        style={{\n          position: 'absolute',\n          left: h.left,\n          width: h.width || cellWidth,\n          height: cellHeight\n        }}\n      >\n        { \n          h.renderHeader\n            ? h.renderHeader(h, h.prop)\n            : renderHeader(h, h.prop)\n        }\n      </div>\n    ))\n  );\n}\n","import React, { useContext, useMemo } from 'react';\nimport DataArea from './DataArea';\nimport Header from './Header';\nimport './style.css';\nimport { CSTableContext } from './index';\nimport FixedLeftColumn from './FixedLeftColumn';\nimport FixedLeftHeader from './FixedLeftHeader';\n\nexport default function CSTable() {\n\n  const {\n    header,\n    data,\n    scrollBarWidth,\n    // width,\n    height = 440,\n    cellWidth = 120,\n    cellHeight = 40,\n    handleScroll,\n    dataAreaRef,\n    headerRef,\n    fixedColLeftRef,\n    colResizeProxyRef,\n    tableRef,\n    fixedLeftColWidth,\n    preventScroll,\n    enableResize = true,\n    dataAreaState: { dataAreaWidth: areaWidthAfterResize}\n  } = useContext(CSTableContext);\n\n  const rowCount = data.length,\n        colCount = header.length;\n\n  const areaWidth = useMemo(() => {\n    if (enableResize) {\n      return header.reduce((acc, curr) => acc + (curr.width || cellWidth), 0);\n    }\n    return colCount * cellWidth;\n  }, [enableResize, header, colCount, cellWidth]);\n\n  const areaHeight = useMemo(() => {\n    return rowCount * cellHeight\n  }, [rowCount, cellHeight]);\n\n  return (\n    <div ref={tableRef} className=\"cs-table\" style={{position: 'relative', height: height}}>\n      \n      {\n        preventScroll && <div style={{position: 'absolute', top: 0, left: 0, right: 0, bottom: 0, zIndex: 2}}/>\n      }\n\n      <div ref={headerRef} style={{overflow: 'hidden', marginLeft: fixedLeftColWidth}}>\n        <div style={{width: (areaWidthAfterResize || areaWidth) + scrollBarWidth, position: 'relative', height: cellHeight}}>\n          <Header />\n        </div>\n      </div>\n\n      {\n        !!fixedLeftColWidth && (\n          <>\n            <div style={{position:'absolute', width: fixedLeftColWidth, top: 0}}>\n              <FixedLeftHeader />\n            </div>\n\n            <div\n              ref={fixedColLeftRef}\n              style={{\n                overflow: 'hidden',\n                height: height - cellHeight,\n                width: fixedLeftColWidth,\n                position: 'absolute',\n                left: 0\n              }}\n            >\n              <div style={{height: areaHeight + scrollBarWidth}}>\n                <FixedLeftColumn />\n              </div>\n            </div>\n          </>\n        )\n      }\n    \n      <div\n        ref={dataAreaRef}\n        style={{\n          position: 'relative',\n          overflow: 'auto',\n          marginLeft: fixedLeftColWidth,\n          height: height - cellHeight,\n        }}\n        onScroll={handleScroll}\n      >\n        <div\n          style={{\n            height: areaHeight,\n            width: areaWidthAfterResize || areaWidth,\n          }}\n        >\n          <DataArea /> \n        </div>\n      </div>\n\n      <div\n        className=\"resize-col-proxy\"\n        ref={colResizeProxyRef}\n        style={{ visibility: 'hidden' }}\n      />\n    </div>\n  );\n}\n","import React, { useState, memo } from 'react';\nimport Table from '../index';\n\nconst header = [\n  {\n    label: 'Operation',\n    fixed: true,\n    prop: 'op',\n    width: 90,\n    renderHeader: (h, p) => <a href=\"#\">Operation</a>,\n    renderCell: () => <a href=\"#\">OP</a>\n  },\n  {\n    label: 'Email (Fixed)',\n    fixed: true,\n    prop: 'email',\n  }\n];\nfor (let i = 0; i < 10; i++) {\n  header.push({\n    label: `H ${i}`,\n    prop: `${i}`,\n  });\n}\n\nconst data = [];\nfor(let r = 0; r < 100000; r++) {\n  const row = {};\n  for(let c = 0; c < 10; c++) {\n    row[c] = `data ${r}:${c}`;\n  }\n  row['email'] = `test_${r}@email.com`;\n  data.push(row);\n}\n\nexport default memo(function() {\n\n  const [count, setCount] = useState(0);\n\n  const [h, setH] = useState(header);\n  const [d, setD] = useState(data);\n  const [preventScroll, setPreventScroll] = useState(false);\n\n  return (\n    <div>\n      {/* <button onClick={() => setD([{email: 'update_email@test.com'}])}>Update Data</button>\n      <button onClick={() => setH([{label: 'Email', prop: 'email'}])}>Update Header</button>\n      <button onClick={() => {setD(data); setH(header);}}> Rstore</button>\n      <button onClick={() => setCount(count + 1)}>Update Count</button>\n      <button onClick={() => setPreventScroll(!preventScroll)}>Toggle fix scroll</button>\n      <p>{count}</p> */}\n\n      <p style={{margin: 23}}> 10 * 100000 (col * row)</p>\n\n      <Table\n        header={h}\n        data={d}\n        cellWidth={200}\n        preventScroll={preventScroll}\n        enableResize={true}\n        // keepScrollStatus={true}\n        // renderCell={(record, prop) => record[prop]}\n        // renderHeader={(header, prop) => header[prop]}\n      />\n    </div>\n  );\n});","import { useEffect, useRef } from 'react';\n\nexport default (fnc, deps) => {\n  const isMountRef = useRef(false);\n\n  useEffect(() => {\n    if (!isMountRef.current) {\n      isMountRef.current = true;\n    } else {\n      return fnc();\n    }\n\n  }, deps);\n}\n","import React, { useRef, useState, useCallback, useMemo } from 'react';\nimport CSTable from './CSTable';\nimport { getScrollBarWidth, processHeaderWidth, getMutableIndexAndCount } from './util';\nimport useUpdateEffect from '../hooks/useUpdateEffect';\n\nconst CSTableContext = React.createContext({});\n\nconst getRangeFromArr = (arr, start, count) => {\n  const res = [];\n  for(let i = 0; i <= count; i++) {\n    const record = arr[start + i]\n    record && res.push(record);\n  }\n  return res;\n}\n\nexport const Provider = (props) => {\n  const {\n    header,\n    data,\n    height = 440,\n    cellWidth = 120,\n    cellHeight = 40,\n    renderCell = (record, rowIndex, prop) => record,\n    renderHeader = (header, prop) => header.label,\n    children,\n    preventScroll = false,\n    enableResize = false,\n    keepScrollStatus = false\n  } = props;\n\n  const dataAreaRef = useRef();\n  const headerRef = useRef();\n  const fixedColLeftRef = useRef();\n  const scrollBarRef = useRef(getScrollBarWidth());\n  const colResizeProxyRef = useRef();\n  const tableRef = useRef();\n\n  const restHeader = useMemo(\n    () => processHeaderWidth(header.filter(h => !h.fixed), cellWidth),\n    [header, cellWidth]\n  );\n  const fixedLeft = useMemo(\n    () => processHeaderWidth(header.filter(h => h.fixed), cellWidth),\n    [header, cellWidth]\n  );\n\n  // design for some fixed element, when data scroll, it has position offset;\n  // eg: datepicker, multi select in cell.\n  const preventScrollRef = useRef();\n  preventScrollRef.current = preventScroll;\n\n  // caculate fixed col width.\n  const fixedLeftColWidth = useMemo(() => {\n    return fixedLeft.reduce((acc, curr)=> acc + (curr.width || cellWidth), 0);\n  }, [fixedLeft, cellWidth]);\n\n  const initWidthCountRef = useRef(Math.ceil((document.body.offsetWidth - fixedLeftColWidth) / cellWidth));\n  const initHeightCountRef = useRef(Math.ceil(height / cellHeight));\n\n  const [dataAreaState, setDataAreaState] = useState(() => ({\n    processedHeader: getRangeFromArr(restHeader, 0, initWidthCountRef.current),\n    processedData: getRangeFromArr(data, 0, initHeightCountRef.current),\n    fixedLeftCol: fixedLeft,\n    rowStartIndex: 0,\n    colStartIndex: 0,\n  }));\n\n  // when data update, scroll to other pos, need to cache prev pos;\n  const scrollStatusCacheRef = useRef({\n    colIndex: 0,\n    rowIndex: 0,\n    scrollTop: 0,\n    colCount: initWidthCountRef.current,\n    rowCount: initHeightCountRef.current,\n  })\n\n  // props update\n  useUpdateEffect(() => {\n    setDataAreaState((preState) => {\n      const {\n        processedData: preData,\n        processedHeader: preHeader,\n        fixedLeftCol: preFixedLeftCol,\n      } = preState;\n\n      const {\n        colIndex,\n        rowIndex,\n        colCount,\n        rowCount,\n        scrollTop,\n      } = scrollStatusCacheRef.current;\n\n      if (preData !== data) {\n        preState.processedData = getRangeFromArr(\n          data,\n          keepScrollStatus ? rowIndex : 0,\n          rowCount || initHeightCountRef.current\n        );\n      }\n\n      if (preHeader !== header) {\n        preState.processedHeader = getRangeFromArr(\n          restHeader,\n          keepScrollStatus ? colIndex : 0,\n          colCount || initWidthCountRef.current\n        );\n      } \n\n      if (preFixedLeftCol !== fixedLeft) {\n        preState.fixedLeftCol = fixedLeft\n      }\n\n      if (keepScrollStatus) {\n        fixedColLeftRef.current && fixedColLeftRef.current.scrollTo(0, scrollTop);\n      } else {\n        dataAreaRef.current && dataAreaRef.current.scrollTo(0, 0)\n        fixedColLeftRef.current && fixedColLeftRef.current.scrollTo(0, 0);\n      }\n\n      return {\n        ...preState,\n      };\n    });\n  }, [data, restHeader, fixedLeft, keepScrollStatus]);\n\n  // cache index, No need 'throttle' for the moment.\n  const handleScroll = useCallback((e) => {\n    const cellTarget = e.currentTarget;\n    if (!cellTarget) return;\n    const {\n      scrollLeft: sLeft,\n      scrollTop: sTop,\n      offsetWidth: oWidth,\n      offsetHeight: oHeight,\n    } = cellTarget;\n\n    let colStartIndex, colRenderCount;\n    if (enableResize) {\n      const { startIndex, count } = getMutableIndexAndCount(restHeader, sLeft, dataAreaRef.current.offsetWidth, cellWidth);\n      colStartIndex = startIndex;\n      colRenderCount = count;\n    } else {\n      colStartIndex = Math.floor(sLeft / cellWidth);\n      colRenderCount = Math.ceil(oWidth / cellWidth);\n    }\n\n    const rowStartIndex = Math.floor(sTop / cellHeight),\n          rowRenderCount = Math.ceil(oHeight / cellHeight);\n\n    if (headerRef.current) {\n      headerRef.current.scrollLeft = sLeft;\n    }\n\n    if (fixedColLeftRef.current) {\n      fixedColLeftRef.current.scrollTop = sTop;\n    }\n\n    const scrollStatus = scrollStatusCacheRef.current;\n\n    // if stay on same cell, do not rerender table.\n    if (scrollStatus.colIndex === colStartIndex && scrollStatus.rowIndex === rowStartIndex) return;\n    // assign new pos.\n    scrollStatus.colIndex = colStartIndex;\n    scrollStatus.rowIndex = rowStartIndex;\n    scrollStatus.colCount = colRenderCount;\n    scrollStatus.rowCount = rowRenderCount;\n    scrollStatus.scrollTop = sTop;\n\n    const processedHeader = getRangeFromArr(restHeader, colStartIndex, colRenderCount);\n    const processedData = getRangeFromArr(data, rowStartIndex, rowRenderCount);\n    \n    setDataAreaState((prevState) => ({\n      ...prevState,\n      processedHeader,\n      processedData,\n      colStartIndex,\n      rowStartIndex,\n    }));\n\n  }, [restHeader, data, cellWidth, cellHeight, dataAreaRef, enableResize]);\n\n  const editorContext = {\n    header: restHeader,\n    data,\n    // renderCell,\n    // width,\n    height,\n    scrollBarWidth: scrollBarRef.current,\n    cellWidth,\n    cellHeight,\n    dataAreaRef,\n    headerRef,\n    fixedColLeftRef,\n    colResizeProxyRef,\n    tableRef,\n    handleScroll,\n    dataAreaState,\n    fixedLeftColWidth,\n    setDataAreaState,\n    preventScroll: preventScrollRef.current,\n    renderCell,\n    renderHeader,\n    enableResize,\n  };\n\n  return (\n    <CSTableContext.Provider value={editorContext}>\n      {children}\n    </CSTableContext.Provider>);\n}\n\nexport {\n  CSTableContext\n};\n\nexport default React.memo(function CSTableProvider(props) {\n  return (\n    <Provider {...props}>\n      <CSTable/>\n    </Provider>\n  );\n});\n","// note: for loop faster than forEach;\n// https://www.incredible-web.com/blog/performance-of-for-loops-with-javascript/\n\n// BFS traverse;\nfunction falttenTree(tree) {\n  const allNodes = [];\n  const queue = [...tree];\n  for (let i = 0; queue[i]; i++) {\n    allNodes.push(queue[i]);\n    queue.push(...queue[i].children);\n  }\n  return allNodes;\n}\n\nexport function processTree(columns = [], spanSeq, opts) {\n  let maxLevel = 1;\n\n  const [firstSpan, secondSpan] = spanSeq;\n\n  function traverse(column, parent) {\n    if (parent) {\n      if (opts.calcTop) {\n        column.top = parent.top + opts.calcTop;\n      }\n      if (opts.calcLeft) {\n        column.left = parent.left + opts.calcLeft;\n      }\n\n      column.level = parent.level + 1;\n      column.parent = parent;\n      if (maxLevel < column.level) {\n        maxLevel = column.level;\n      }\n    } else {\n      column.level = 0;\n      if (opts.calcTop) {\n        column.top = 0;\n      }\n      if (opts.calcLeft) {\n        column.left = 0;\n      }\n    }\n\n    if (column.children.length) {\n      let span = 0;\n      column.children.forEach((subColumn) => {\n        traverse(subColumn, column);\n        span += subColumn[firstSpan];\n      });\n      column[firstSpan] = span;\n    } else {\n      column[firstSpan] = 1;\n    }\n  }\n\n  columns.forEach((column) => {\n    traverse(column);\n  });\n\n  const rows = [];\n  for (let i = 0; i <= maxLevel; i++) {\n    rows.push([]);\n  }\n\n  const allColumns = falttenTree(columns);\n\n  allColumns.forEach((column) => {\n    if (!column.children.length) {\n      column[secondSpan] = maxLevel - column.level + 1;\n    } else {\n      column[secondSpan] = 1;\n    }\n    rows[column.level].push(column);\n  });\n\n  return {\n    flattenRow: rows,\n    allColumns,\n  };\n}\n\nexport function getLeafNodes(nodes = []) {\n  const result = [];\n  nodes.forEach((node) => {\n    if (node.children && node.children.length) {\n      result.push(...getLeafNodes(node.children));\n    } else {\n      node.isLeaf = true;\n      result.push(node);\n    }\n  });\n  return result;\n}\n\nexport function getDeepestNodePath(allNode = [], cellWidth, cellHeight) {\n  // deepest node\n  let dn = allNode[allNode.length - 1];\n  const deepestPath = [];\n  while (dn) {\n    if (!dn.height) {\n      dn.height = cellHeight;\n    }\n    if (!dn.width) {\n      dn.width = cellWidth;\n    }\n    deepestPath.unshift(dn);\n    dn = dn.parent;\n  }\n\n  return deepestPath;\n}\n\nexport function calcDeepsetNodePathOffset(deepestPath, measure) {\n  const offsetType = measure === 'width' ? 'left' : 'top';\n  deepestPath.reduce((acc, curr) => {\n    curr[offsetType] = acc;\n    return acc + curr[measure];\n  }, 0);\n}\n\nexport function travelToRootFromLeafNodes(leafNodes, prop, defaultValue) {\n  // leaf nodes; Complexity: O(leaf.length * deepest);\n  const set = new Set();\n  leafNodes.forEach((node) => {\n    node[prop] = node[prop] || defaultValue\n    let accValue = node[prop];\n    let parent = node.parent;\n\n    // reset measure, when rebuild tree, this value incorrect\n    if (parent && !set.has(parent)) {\n      parent[prop] = 0;\n      set.add(parent);\n    };\n\n    while (parent) {\n      let parentProp = parent[prop] || 0;\n      parent[prop] = parentProp + accValue;\n      accValue = parentProp + accValue;\n      parent = parent.parent;\n    }\n  });\n}\n\nexport function calcNodeOffsetFormFalttenHeader(flattenRow, prop, measure) {\n  for (let i = 0, iLength = flattenRow.length; i < iLength; i++) {\n    let acc = 0;\n    for (let j = 0, jLength = flattenRow[i].length; j < jLength; j++) {\n      const curr = flattenRow[i][j];\n\n      acc = acc === 0\n        ? curr.parent\n          ? curr.parent[prop]\n          : 0\n        : acc;\n\n      curr[prop] = acc;\n      acc += curr[measure];\n    }\n  }\n}\n\nexport function calcMeasureFromDeepestPath(allNode, deepestPath, measure) {\n  const offsetType = measure === 'width' ? 'left' : 'top';\n  for (let i = 0, iLength = allNode.length; i < iLength; i++) {\n    const node = allNode[i];\n    const { rowSpan, colSpan, level } = node;\n    if (deepestPath.indexOf(allNode[i]) !== -1) continue;\n    node[offsetType] = deepestPath[node.level][offsetType];\n    allNode[i][measure] = 0;\n    for (var j = level, jLength = (measure === 'height' ? rowSpan : colSpan) + level; j < jLength; j++) {\n      allNode[i][measure] += deepestPath[j][measure];\n    };\n  }\n}\n\nexport function binSearch(scroll, arr, measure) {\n  let start = 0,\n    mid = Math.floor(arr.length / 2),\n    end = arr.length;\n\n  // if not scroll, return start;\n  if (arr.length && arr[0][measure] > scroll) {\n    return start;\n  }\n\n  const offset = measure === 'width' ? 'left' : 'top';\n  while ((end - start) > 1) {\n    if (arr[mid][offset] < scroll) {\n      start = mid;\n    }\n    if (arr[mid][offset] >= scroll) {\n      end = mid;\n    }\n    mid = Math.floor((start + end) / 2);\n  }\n  return start;\n}\n\nexport function getSubTreeFromStartNode(startIndex, leafNodes, measure, measuerLength) {\n  let acc = 0;\n  const parentHeaderInView = [];\n  const subLeafNode = [];\n\n  // prevent blank;\n  const safeLength = measuerLength + 30;\n  for (let i = startIndex, l = leafNodes.length; i < l; i++) {\n    acc += leafNodes[i][measure];\n    subLeafNode.push(leafNodes[i]);\n    if (acc > safeLength) {\n      break;\n    }\n  }\n\n  const ws = new Set();\n  subLeafNode.forEach((n) => {\n    while (n.parent && !ws.has(n.parent)) {\n      parentHeaderInView.push(n.parent);\n      ws.add(n.parent);\n    }\n  });\n\n  return [...parentHeaderInView, ...subLeafNode];\n}\n\n// get the last child\nexport function getLastNode(node) {\n  let tn = node;\n  while(tn && tn.children.length) {\n    const l = tn.children.length;\n    tn = tn.children[l-1];\n  }\n  return tn;\n}\n\nexport function getNodeByProp(rawHeader, prop) {\n  let foundNode = null;\n  const recursion = (node) => {\n    if (node.prop === prop) {\n      foundNode = node;\n      return true;\n    }\n    node.children && node.children.forEach((cn) => {\n      recursion(cn);\n    });\n  }\n\n  for(let i = 0, l = rawHeader.length; i < l; i++) {\n    if (recursion(rawHeader[i])) break;\n  }\n\n  return foundNode;\n}\n\nfunction switchNode(nodes, fIndex, sIndex) {\n  const t = nodes[fIndex];\n  nodes[fIndex] = nodes[sIndex];\n  nodes[sIndex] = t;\n}\n\nexport function switchPosByProps(rawHeader, firstProp, secondProp) {\n  const firstNode = getNodeByProp(rawHeader, firstProp),\n        secondNode = getNodeByProp(rawHeader, secondProp);\n\n  if (!firstNode || !secondNode) {\n    console.warn('Can not find node.');\n    return false;\n  }\n\n  if (firstNode.parent !== secondNode.parent) {\n    console.warn('Can not switch nodes, because it has diff parent.');\n    return false;\n  }\n\n  if (!firstNode.parent) {\n    const fIndex = rawHeader.indexOf(firstNode);\n    const sIndex = rawHeader.indexOf(secondNode);\n    switchNode(rawHeader, fIndex, sIndex);\n  } else {\n    const nodes = firstNode.parent.children;\n    const fIndex = nodes.indexOf(firstNode);\n    const sIndex = nodes.indexOf(secondNode);\n    switchNode(nodes, fIndex, sIndex);\n  }\n  return true;\n}\n","import { useState, useMemo, useCallback, useRef, useEffect } from \"react\";\nimport {\n  processTree,\n  calcNodeOffsetFormFalttenHeader,\n  getLeafNodes,\n  travelToRootFromLeafNodes,\n  calcMeasureFromDeepestPath,\n  getDeepestNodePath,\n  switchPosByProps,\n} from './util';\nimport useForceUpdate from \"../hooks/useForceUpdate\";\nimport useUpdateEffect from \"../hooks/useUpdateEffect\";\n\nexport default function useColHeader({colHeader: rawHeader, cellWidth, cellHeight}) {\n\n  const rawHeaderRef = useRef(rawHeader);\n  const {forceUpdate, updateCount} = useForceUpdate();\n\n  const {flattenRow, allColumns} = useMemo(\n    () =>  processTree(rawHeaderRef.current, ['colSpan', 'rowSpan'], { calcTop: cellHeight })\n  , [rawHeaderRef.current, updateCount]);\n\n  const buildHeaderTree = useCallback(() => {\n    // use leaf nodes calc width & prop\n    const leafNodes = getLeafNodes(rawHeaderRef.current);\n\n    // calculate width;\n    travelToRootFromLeafNodes(leafNodes, 'width', cellWidth);\n\n    // calculate left;\n    calcNodeOffsetFormFalttenHeader(flattenRow, 'left', 'width');\n\n    // use deepestnode store height\n    const deepestNodePath = getDeepestNodePath(allColumns, cellWidth, cellHeight);\n    calcMeasureFromDeepestPath(allColumns, deepestNodePath, 'height');\n    \n    const colHeaderHeight = deepestNodePath.reduce((acc, curr) => acc + curr.height, 0);\n    const colHeaderWidth = leafNodes.reduce((acc, curr) => acc + curr.width, 0);\n\n    return {\n      colHeaderHeight,\n      colHeaderWidth,\n      colHeaderLeaf: leafNodes,\n    }\n  }, [rawHeaderRef.current, flattenRow, allColumns]);\n\n  const [measure, setMeasure] = useState(() => buildHeaderTree());\n\n  const handleColSort = useCallback((p1, p2) => {\n    const switchSuccess = switchPosByProps(rawHeaderRef.current, p1, p2);\n    if (switchSuccess) {\n      forceUpdate();\n    }\n  }, [rawHeaderRef.current, forceUpdate]);\n\n  const rebuildColHeader = useCallback(() => {\n    setMeasure(buildHeaderTree());\n  }, [buildHeaderTree, setMeasure]);\n\n  useUpdateEffect(() => {\n    if (updateCount!==0) {\n      rebuildColHeader();\n    }\n  }, [updateCount, rebuildColHeader]);\n \n  return {\n    colHeader: allColumns,\n    rebuildColHeader,\n    ...measure,\n    handleColSort,\n  };\n  \n}\n","import { useState, useCallback } from 'react';\n\ntype ForceUpdateRes = {\n  updateCount: number;\n  forceUpdate: Function;\n}\n\nexport default (): ForceUpdateRes => {\n  const [updateCount, update] = useState(0);\n\n  const forceUpdate = useCallback(() => {\n    update((p:number) => p + 1);\n  }, [update]);\n\n  return {\n    updateCount,\n    forceUpdate\n  };\n}\n","import { useCallback, useMemo, useRef, useState } from \"react\"\n\ninterface DropOpts {\n  handleDrop: (dragProp: string, dropProp: string) => void;\n}\n\ninterface DropProps {\n  onDrop: React.DragEventHandler;\n  onDragEnter: React.DragEventHandler;\n  onDragLeave: React.DragEventHandler;\n  onDragOver: React.DragEventHandler;\n}\n\ninterface DropRes  {\n  dropProps: DropProps;\n  hoverProp: string;\n  setHoverProp: (prop: string) => void\n}\n\nexport const useDrop = (opts: DropOpts) => {\n  const optsRef = useRef(opts);\n  optsRef.current = opts;\n\n  const [hoverProp, setHoverProp] = useState('');\n  \n  const dropProps = useMemo(() => ({\n    onDrop: (e: React.DragEvent<HTMLElement>) => {\n      e.preventDefault();\n      e.persist();\n      if (optsRef.current.handleDrop) {\n        optsRef.current.handleDrop(e.dataTransfer.getData('dragProp'), e.currentTarget.dataset.prop || '');\n      }\n    },\n    onDragEnter: (e: React.DragEvent<HTMLElement>) => {\n      e.preventDefault();\n      console.log('on drag enter：', e.currentTarget.dataset.parentProp);\n      setHoverProp(e.currentTarget.dataset.parentProp as string);\n    },\n    onDragLeave: (e: any) => {\n      console.log('on drag leave',e.currentTarget.dataset.prop);\n      setHoverProp('');\n    },\n    onDragOver: (e: React.DragEvent) => {\n      e.preventDefault();\n    }\n  }), [optsRef, setHoverProp]);\n\n  return {dropProps, hoverProp, setHoverProp};\n}\n\ninterface DragOpts {\n  handleDrag: (dragProp: string) => void;\n}\n\nexport const useDrag = (opts: DragOpts) => {\n\n  const optsRef = useRef(opts);\n  optsRef.current = opts;\n\n  const getDragProps = useCallback((prop) => {\n    return {\n      key: JSON.stringify(prop),\n      draggable: 'true' as const,\n      onDragStart: (e: React.DragEvent) => {\n        optsRef.current.handleDrag && optsRef.current.handleDrag(prop);\n        e.dataTransfer.setData('dragProp', prop);\n      }\n    }\n  }, [optsRef]);\n\n  return getDragProps;\n}","import React, { useMemo } from 'react';\nimport { useDrag, useDrop } from '../hooks/useDragAndDrop';\n\ninterface Header {\n  top: number;\n  left: number;\n  width: number;\n  height: number;\n  prop: string;\n  label: string;\n  parent: Header;\n}\n\ninterface HeaderProps {\n  header: Header;\n  resizeProps: object;\n  dragParentRef: React.MutableRefObject<string>;\n  handleColSort: Function;\n  enableSorting: boolean;\n}\n\nexport default ({\n  header,\n  resizeProps,\n  dragParentRef,\n  handleColSort,\n  enableSorting,\n}: HeaderProps) => {\n\n  const {\n    top,\n    left,\n    width,\n    height,\n    prop,\n    label\n  }= header;\n\n  const getDragProps = useDrag({\n    handleDrag: () => {\n      dragParentRef.current = header.parent?.prop;\n    }\n  });\n\n  const { dropProps, hoverProp, setHoverProp } = useDrop({\n    handleDrop: (dragProp, dropProp) => {\n      if (dragProp !== dropProp) {\n        handleColSort(dragProp, dropProp);\n      }\n      dragParentRef.current = 'UNDEFINED_SHEET';\n      setHoverProp('');\n    }\n  });\n\n  // dyn add props\n  const sortingProps = useMemo(() => (\n    enableSorting\n      ? {\n          ...getDragProps(prop),\n          ...dropProps,\n        }\n      : {}\n  ), [prop]);\n\n  if (hoverProp !== dragParentRef.current) {\n    console.log(hoverProp, dragParentRef.current);\n  }\n\n  return (\n    <div\n      className=\"header\"\n      style={{\n        position: 'absolute',\n        top: top,\n        left: left,\n        width: width,\n        height: height,\n        outline: hoverProp === dragParentRef.current\n                  ? '2px dashed green'\n                  : 'none',\n        outlineOffset: -2\n      }}\n      data-prop={prop}\n      data-parent-prop={header.parent?.prop}\n      {...sortingProps}\n      {...resizeProps}\n    >\n      {label}\n    </div>\n  );\n}","import React, { useMemo, useCallback, useRef } from 'react';\nimport { getScrollBarWidth } from '../table/util';\nimport useResize from '../hooks/useResize';\nimport { getLastNode } from './util';\nimport HeaderCell from './HeaderCell';\n\nexport function ColHeader({\n  dynColHeader,\n  colHeaderWidth,\n  colHeaderHeight,\n  enableColResize,\n  enableRowResize,\n  containerRef,\n  colResizeProxyRef,\n  onUpdate,\n  handleColSort,\n  enableColSorting,\n}) {\n\n  const onResizeStop = useCallback((offset, prop) => {\n    let h = dynColHeader.find(h => h.prop === prop);\n    if (!h.isLeaf) {\n      h = getLastNode(h);\n    }\n\n    if (h && offset) {\n      h.width = Math.max(h.width + offset, 30);\n    }\n\n    onUpdate && onUpdate();\n  }, [dynColHeader]);\n\n  const { handleMouseMove, handleMouseOut, handleMouseDown } = useResize({\n    container: containerRef,\n    colResizeProxy: colResizeProxyRef,\n    onResizeStop,\n  });\n\n  const resizeProps = useMemo(() => (\n    enableColResize || enableRowResize\n      ? {\n        onMouseMove: handleMouseMove,\n        onMouseOut: handleMouseOut,\n        onMouseDown: handleMouseDown,\n      }\n      : {}\n  ), [enableColResize, enableRowResize, handleMouseMove, handleMouseOut, handleMouseDown]);\n\n  const dragParentRef = useRef('UNDEFINED_SHEET');\n\n  return (\n    <div\n      style={{\n        position: 'relative',\n        height: colHeaderHeight,\n        width: colHeaderWidth + getScrollBarWidth(),\n      }}\n    >\n      {\n        dynColHeader.map((header) => (\n          <HeaderCell\n            key={header.prop}\n            header={header}\n            resizeProps={resizeProps}\n            dragParentRef={dragParentRef}\n            handleColSort={handleColSort}\n            enableSorting={enableColSorting}\n          />\n        ))\n      }\n    </div>\n  );\n}","import React, { useMemo, useCallback } from 'react';\nimport { getScrollBarWidth } from '../table/util';\nimport useResize from '../hooks/useResize';\n\nexport function RowHeader({\n  dynRowHeader,\n  rowHeaderWidth,\n  rowHeaderHeight,\n  rowDeepestPath,\n  enableColResize,\n  enableRowResize,\n  containerRef,\n  colResizeProxyRef,\n  onUpdate,\n  enableSorting = true,\n}) {\n\n  const onResizeStop = useCallback((offset, prop) => {\n    let h = dynRowHeader.find(h => h.prop === prop);\n\n    h = rowDeepestPath[h.level];\n\n    if (h && offset) {\n      h.width = Math.max(h.width + offset, 30);\n    }\n\n    onUpdate && onUpdate();\n  }, [dynRowHeader, rowDeepestPath]);\n\n  const { handleMouseMove, handleMouseOut, handleMouseDown } = useResize({\n    container: containerRef,\n    colResizeProxy: colResizeProxyRef,\n    onResizeStop,\n  });\n\n  const resizeProps = useMemo(() => (\n    enableColResize || enableRowResize\n      ? {\n        onMouseMove: handleMouseMove,\n        onMouseOut: handleMouseOut,\n        onMouseDown: handleMouseDown,\n      }\n      : {}\n  ), [enableColResize, enableRowResize, handleMouseMove, handleMouseOut, handleMouseDown]);\n\n  return (\n    <div\n      style={{\n        position: 'relative',\n        height: rowHeaderHeight + + getScrollBarWidth(),\n        width: rowHeaderWidth,\n      }}\n    >\n      {\n        dynRowHeader.map(({ top, left, width, height, label, prop }) => (\n          <div\n            className=\"header\"\n            key={prop}\n            style={{\n              position: 'absolute',\n              top: top,\n              left: left,\n              width: width,\n              height: height,\n            }}\n            data-prop={prop}\n            {...resizeProps}\n          >\n            {label}\n          </div>\n        ))\n      }\n    </div>\n  );\n}","import React, { useRef, useCallback, useState, useEffect } from 'react';\n\nimport useColHeader from './useColHeader';\nimport useRowHeader from './useRowHeader';\nimport { getSubTreeFromStartNode, binSearch } from './util';\nimport { ColHeader } from './ColHeader';\nimport { RowHeader } from './RowHeader';\nimport useUpdateEffect from '../hooks/useUpdateEffect';\n\nexport default function (props) {\n\n  const {\n    colHeader,\n    rowHeader,\n    data,\n    height = 400,\n    width = 800,\n    cellHeight = 40,\n    cellWidth = 100,\n    renderCell = (record, rowProp, colProp, data) => record,\n    enableColResize = false,\n    enableRowResize = false,\n    enableColSorting = false,\n    enableRowSorting = false,\n  } = props;\n\n  const {\n    colHeaderWidth,\n    colHeaderHeight,\n    colHeaderLeaf,\n    rebuildColHeader,\n    handleColSort,\n  } = useColHeader({ colHeader, cellWidth, cellHeight });\n\n  const {\n    rowHeaderWidth,\n    rowHeaderHeight,\n    rowHeaderLeaf,\n    rebuildRowHeader,\n    rowDeepestPath,\n  } = useRowHeader({ rowHeader, cellWidth, cellHeight });\n\n  const sheetRef = useRef();\n  const dataAreaRef = useRef();\n  const rowHeaderRef = useRef();\n  const colHeaderRef = useRef();\n  const colResizeProxyRef = useRef();\n\n  // component state\n  const [{ dynColHeader, dynRowHeader }, setState] = useState(() => {\n    return {\n      dynColHeader: getSubTreeFromStartNode(0, colHeaderLeaf, 'width', width),\n      dynRowHeader: getSubTreeFromStartNode(0, rowHeaderLeaf, 'height', height),\n    };\n  });\n\n  const cacheRef = useRef({\n    colIndexCache: 0,\n    rowIndexCache: 0,\n  });\n\n  // cache index, No need 'throttle' for the moment.\n  const handleScroll = useCallback((e) => {\n    const target = e.currentTarget;\n    if (!target) return;\n    const { scrollTop, scrollLeft, clientHeight, clientWidth } = target;\n    colHeaderRef.current.scrollLeft = scrollLeft;\n    rowHeaderRef.current.scrollTop = scrollTop;\n\n    const { colIndexCache, rowIndexCache } = cacheRef.current;\n\n    const currColIndex = binSearch(scrollLeft, colHeaderLeaf, 'width');\n    const currRowIndex = binSearch(scrollTop, rowHeaderLeaf, 'height');\n\n    // if stay on same cell, do not rerender table.\n    if (colIndexCache === currColIndex && rowIndexCache === currRowIndex) return;\n\n    let newCol;\n    if (colIndexCache !== currColIndex) {\n      // todo get sub tree;\n      newCol = getSubTreeFromStartNode(currColIndex, colHeaderLeaf, 'width', clientWidth);\n      cacheRef.current.colIndexCache = currColIndex;\n    }\n\n    let newRow;\n    if (rowIndexCache !== currRowIndex) {\n      // todo get sub tree;\n      newRow = getSubTreeFromStartNode(currRowIndex, rowHeaderLeaf, 'height', clientHeight);\n      cacheRef.current.rowIndexCache = currRowIndex;\n    }\n\n    setState((pre) => {\n      return {\n        dynColHeader: newCol ? newCol : pre.dynColHeader,\n        dynRowHeader: newRow ? newRow : pre.dynRowHeader,\n      };\n    });\n\n  }, [setState, colHeaderLeaf]);\n\n  // sorting effect.\n  useUpdateEffect(() => {\n    const { colIndexCache, rowIndexCache } = cacheRef.current;\n    const newCol = getSubTreeFromStartNode(colIndexCache, colHeaderLeaf, 'width', width);\n    const newRow = getSubTreeFromStartNode(rowIndexCache, rowHeaderLeaf, 'height', height);\n    setState((pre) => {\n      return {\n        dynColHeader: newCol ? newCol : pre.dynColHeader,\n        dynRowHeader: newRow ? newRow : pre.dynRowHeader,\n      };\n    });\n  }, [colHeaderLeaf, rowHeaderLeaf, width, height]);\n\n  return (\n    <div\n      className=\"cs-sheet\"\n      style={{\n        height,\n        position: 'relative',\n      }}\n      ref={sheetRef}\n    >\n\n      <div\n        className=\"corner\"\n        style={{\n          height: colHeaderHeight,\n          width: rowHeaderWidth,\n          position: 'absolute',\n        }}\n      />\n\n      <div\n        className=\"cs-sheet-col-header\"\n        style={{\n          marginLeft: rowHeaderWidth,\n          overflow: 'hidden',\n        }}\n        ref={colHeaderRef}\n      >\n        <ColHeader\n          dynColHeader={dynColHeader}\n          colHeaderHeight={colHeaderHeight}\n          colHeaderWidth={colHeaderWidth}\n          containerRef={sheetRef}\n          colResizeProxyRef={colResizeProxyRef}\n          enableColResize={enableColResize}\n          enableRowResize={enableRowResize}\n          enableColSorting={enableColSorting}\n          onUpdate={rebuildColHeader}\n          handleColSort={handleColSort}\n        />\n      </div>\n\n      <div className=\"cs-sheet-row-header\"\n        style={{\n          overflow: 'hidden',\n          height: height - colHeaderHeight,\n          // marginTop: colHeaderHeight,\n        }}\n        ref={rowHeaderRef}\n      >\n        <RowHeader\n          dynRowHeader={dynRowHeader}\n          rowDeepestPath={rowDeepestPath}\n          rowHeaderHeight={rowHeaderHeight}\n          rowHeaderWidth={rowHeaderWidth}\n          containerRef={sheetRef}\n          colResizeProxyRef={colResizeProxyRef}\n          enableColResize={enableColResize}\n          enableRowResize={enableRowResize}\n          enableRowSorting={enableRowSorting}\n          onUpdate={rebuildRowHeader}\n        />\n      </div>\n\n      <div\n        style={{\n          position: 'absolute',\n          top: colHeaderHeight,\n          left: rowHeaderWidth,\n          bottom: 0,\n          right: 0,\n          overflow: 'auto',\n        }}\n        onScroll={handleScroll}\n        ref={dataAreaRef}\n      >\n        <div\n          style={{\n            width: colHeaderWidth,\n            height: rowHeaderHeight,\n          }}\n        >\n          {\n            rowHeaderLeaf.map((row, rowIndex) => (\n              colHeaderLeaf.map((col, colIndex) => (\n                <div\n                  className=\"cell\"\n                  key={`d-a-${rowIndex}-${colIndex}`}\n                  style={{\n                    position: 'absolute',\n                    width: col.width,\n                    height: row.height,\n                    left: col.left,\n                    top: row.top,\n                  }}\n                >\n                  {\n                    renderCell(data[row.prop][col.prop], row.prop, col.prop, data)\n                  }\n                </div>\n              ))\n            ))\n          }\n        </div>\n      </div>\n\n      <div\n        className=\"resize-col-proxy\"\n        ref={colResizeProxyRef}\n        style={{ visibility: 'hidden' }}\n      />\n    </div>\n  )\n}","import { useState, useCallback, useMemo } from \"react\";\nimport {\n  processTree,\n  getLeafNodes,\n  travelToRootFromLeafNodes,\n  calcNodeOffsetFormFalttenHeader,\n  getDeepestNodePath,\n  calcMeasureFromDeepestPath,\n  calcDeepsetNodePathOffset,\n} from './util';\n\nexport default function useRowHeader({rowHeader: rawHeader, cellWidth, cellHeight}) {\n\n  const {flattenRow, allColumns}= useMemo(\n    () => processTree(rawHeader, ['rowSpan', 'colSpan'], { calcLeft: cellWidth })\n  , []);\n\n  const buildHeaderTree = useCallback(() => {\n    // use leaf nodes calc width & prop\n    const leafNodes = getLeafNodes(rawHeader);\n\n    // caculate height;\n    travelToRootFromLeafNodes(leafNodes, 'height', cellHeight);\n\n    // caculate top;\n    calcNodeOffsetFormFalttenHeader(flattenRow, 'top', 'height');\n\n    // use deepestnode store width\n    const deepestNodePath = getDeepestNodePath(allColumns, cellWidth, cellHeight);\n    calcDeepsetNodePathOffset(deepestNodePath, 'width');\n    calcMeasureFromDeepestPath(allColumns, deepestNodePath, 'width');\n\n    const rowHeaderWidth = deepestNodePath.reduce((acc, curr) => acc + curr.width, 0);\n    const rowHeaderHeight = leafNodes.reduce((acc, curr) => acc + curr.height, 0);\n\n    return {\n      rowHeaderWidth,\n      rowHeaderHeight,\n      rowHeaderLeaf: leafNodes,\n      rowDeepestPath: deepestNodePath,\n    }\n  }, [rawHeader, flattenRow, allColumns]);\n\n  const [measure, setMeasure] = useState(() => buildHeaderTree());\n\n  const rebuildRowHeader = useCallback(() => {\n    setMeasure(buildHeaderTree());\n  }, [buildHeaderTree, setMeasure]);\n\n  return {\n    rowHeader: allColumns,\n    rebuildRowHeader,\n    ...measure,\n  };\n  \n}\n","import React from 'react';\nimport Sheet from './index';\nimport { useSize } from '../hooks/useSize';\n\nexport default function (props) {\n  const [state, ref] = useSize();\n  const { width, height } = state;\n\n  return (\n    <div\n      ref={ref}\n      style={{\n        height: '100%',\n        width: '100%',\n      }}\n    >\n      {\n        !!width && !!height && <Sheet {...props} width={width} height={height} />\n      }\n    </div>\n  );\n}","import { useState, useLayoutEffect, useRef } from \"react\";\n\nexport function useSize() {\n  const [state, setState] = useState({\n    width: 0,\n    height: 0,\n  });\n\n  const domRef = useRef();\n\n  useLayoutEffect(() => {\n    const { clientHeight, clientWidth } = domRef.current;\n    setState({\n      width: clientWidth,\n      height: clientHeight,\n    });\n  }, []);\n\n  return [state, domRef];\n}","export default {\n  rowHeader:[\n    {\n      label: \"广东\",\n      prop: 'gd',\n      children: [\n        {\n          label: \"广州\",\n          prop: 'gd-gz',\n          children: [],\n        },\n        {\n          label: \"佛山\",\n          prop: 'gd-fs',\n          children: [],\n        },\n        {\n          label: \"珠海\",\n          prop: 'gd-zh',\n          children: [],\n        },\n        {\n          label: \"东莞\",\n          prop: 'gd-dg',\n          children: [],\n        },\n      ],\n    },\n    {\n      label: \"江苏\",\n      prop: 'js',\n      children: [\n        {\n          label: \"南京\",\n          prop: 'js-nj',\n          children: [],\n        },\n        {\n          label: \"无锡\",\n          prop: 'js-wx',\n          children: [],\n        },\n        {\n          label: \"徐州\",\n          prop: 'js-xz',\n          children: [],\n        },\n        {\n          label: \"常州\",\n          prop: 'js-cz',\n          children: [],\n        },\n      ],\n    },\n    {\n      label: \"山东\",\n      prop: 'sd',\n      children: [\n        {\n          label: \"济南\",\n          prop: 'sd-jning',\n          children: [],\n        },\n        {\n          label: \"青岛\",\n          prop: 'sd-qd',\n          children: [],\n        },\n        {\n          label: \"烟台\",\n          prop: 'sd-yt',\n          children: [],\n        },\n        {\n          label: \"济宁\",\n          prop: 'sd-jn',\n          children: [],\n        },\n      ],\n    },\n    \n    {\n      label: \"浙江\",\n      prop: 'zj',\n      children: [\n        {\n          label: \"杭州\",\n          prop: 'zj-hz',\n          children: [],\n        },\n        {\n          label: \"宁波\",\n          prop: 'zj-nb',\n          children: [],\n        },\n        {\n          label: \"温州\",\n          prop: 'zj-wz',\n          children: [],\n        },\n        {\n          label: \"绍兴\",\n          prop: 'zj-zx',\n          children: [],\n        },\n      ],\n    },\n  ],\n  colHeader:[{\n    label: \"2018\",\n    prop: \"2018\",\n    children: [{\n      label: \"Q1\",\n      prop: \"2018-Q1\",\n      children: [],\n    }, {\n      label: \"Q2\",\n      prop: \"2018-Q2\",\n      children: [],\n    }, {\n      label: \"Q3\",\n      prop: \"2018-Q3\",\n      children: [],\n    }, {\n      label: \"Q4\",\n      prop: \"2018-Q4\",\n      children: [],\n    }],\n  }, {\n    label: \"2019\",\n    prop: \"2019\",\n    children: [{\n      label: \"Q1\",\n      prop: \"2019-Q1\",\n      children: [],\n    }, {\n      label: \"Q2\",\n      prop: \"2019-Q2\",\n      children: [],\n    }, {\n      label: \"Q3\",\n      prop: \"2019-Q3\",\n      children: [],\n    }, {\n      label: \"Q4\",\n      prop: \"2019-Q4\",\n      children: [],\n    }],\n  },{\n    label: \"2020\",\n    prop: \"2020\",\n    children: [{\n      label: \"Q1\",\n      prop: \"2020-Q1\",\n      children: [],\n    }, {\n      label: \"Q2\",\n      prop: \"2020-Q2\",\n      children: [],\n    }, {\n      label: \"Q3\",\n      prop: \"2020-Q3\",\n      children: [],\n    }, {\n      label: \"Q4\",\n      prop: \"2020-Q4\",\n      children: [],\n    }],\n  }, {\n    label: \"2021\",\n    prop: \"2021\",\n    children: [{\n      label: \"Q1\",\n      prop: \"2021-Q1\",\n      children: [],\n    }, {\n      label: \"Q2\",\n      prop: \"2021-Q2\",\n      children: [],\n    }, {\n      label: \"Q3\",\n      prop: \"2021-Q3\",\n      children: [],\n    }, {\n      label: \"Q4\",\n      prop: \"2021-Q4\",\n      children: [],\n    }],\n  }],\n  data: {\n    'gd-gz': {\n      \"2018-Q1\": 1,\n      \"2018-Q2\": 2,\n      \"2018-Q3\": 3,\n      \"2018-Q4\": 4,\n      \"2019-Q1\": 5,\n      \"2019-Q2\": 6,\n      \"2019-Q3\": 7,\n      \"2019-Q4\": 8,\n    },\n    'gd-fs': {\n      \"2018-Q1\": 2,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'gd-zh': {\n      \"2018-Q1\": 3,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'gd-dg': {\n      \"2018-Q1\": 4,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'js-nj': {\n      \"2018-Q1\": 5,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'js-wx': {\n      \"2018-Q1\": 6,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'js-xz': {\n      \"2018-Q1\": 7,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'js-cz': {\n      \"2018-Q1\": 8,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'sd-jning': {\n      \"2018-Q1\": 8,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'sd-qd': {\n      \"2018-Q1\": 8,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'sd-yt': {\n      \"2018-Q1\": 8,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'sd-jn': {\n      \"2018-Q1\": 8,\n      \"2018-Q2\": 3244,\n      \"2018-Q3\": 4903,\n      \"2018-Q4\": 8903,\n      \"2019-Q1\": 5423,\n      \"2019-Q2\": 4567,\n      \"2019-Q3\": 8976,\n      \"2019-Q4\": 1945,\n    },\n    'zj-hz': {\n\n    },\n    'zj-nb': {\n\n    },\n    'zj-wz': {\n\n    },\n    'zj-zx': {\n\n    }\n  }\n};","import React from 'react';\nimport Sheet from '../index';\nimport AutoSizeSheet from '../AutoSize';\n\nimport simpleData from './data';\n\nexport default function() {\n  const { rowHeader, colHeader, data } = simpleData;\n  return (\n    <div>\n      {/* <Sheet\n        rowHeader={rowHeader}\n        colHeader={colHeader}\n        data={data}\n        enableResize\n        enableSortHeader\n      /> */}\n\n      <div\n        style={{\n          height: 400,\n        }}\n      >\n        <AutoSizeSheet\n          rowHeader={rowHeader}\n          colHeader={colHeader}\n          data={data}\n          cellWidth={120}\n          cellHeight={44}\n          enableColResize\n          enableColSorting\n        />\n      </div>\n    </div>\n  )\n}","import React from 'react';\nimport './App.css';\nimport Table from './component';\nimport data from './data';\nimport CSTable from './table/demo/demo1';\n\nimport Sheet from './sheet/demo/demo1';\n\nexport default class App extends React.Component {\n\n  state = {\n    rowHeader: data.rowHeader,\n    columnHeader: data.columnHeader,\n    data: data.data,\n  }\n\n\n  render() {\n    const {\n      columnHeader,\n      rowHeader,\n      data,\n    } = this.state;\n    return (\n      <div className=\"App\">\n        <h1>High performance table</h1>\n\n        <div style={{margin: 15}}>\n          <CSTable />\n        </div>\n\n        <h1>Sheet</h1>\n        <div style={{margin: 15}}>\n          <Sheet />\n        </div>\n        {/* <Table\n          columnHeader={columnHeader}\n          rowHeader={rowHeader}\n          data={data}\n        /> */}\n      </div>\n    );\n  }\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}